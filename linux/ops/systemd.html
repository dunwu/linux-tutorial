<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Systemd åº”ç”¨ | LINUX-TUTORIAL</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/linux-tutorial/favicon.ico">
    <meta name="description" content="æ•°æ®åº“æ•™ç¨‹">
    
    <link rel="preload" href="/linux-tutorial/assets/css/0.styles.45d9d031.css" as="style"><link rel="preload" href="/linux-tutorial/assets/js/app.79a38eea.js" as="script"><link rel="preload" href="/linux-tutorial/assets/js/4.fb6e0f89.js" as="script"><link rel="preload" href="/linux-tutorial/assets/js/45.d49955bd.js" as="script"><link rel="preload" href="/linux-tutorial/assets/js/5.cb43ecfb.js" as="script"><link rel="prefetch" href="/linux-tutorial/assets/js/10.7933187b.js"><link rel="prefetch" href="/linux-tutorial/assets/js/11.b9b41530.js"><link rel="prefetch" href="/linux-tutorial/assets/js/12.70a5dba8.js"><link rel="prefetch" href="/linux-tutorial/assets/js/13.857dcc43.js"><link rel="prefetch" href="/linux-tutorial/assets/js/14.5a603a55.js"><link rel="prefetch" href="/linux-tutorial/assets/js/15.d217acb7.js"><link rel="prefetch" href="/linux-tutorial/assets/js/16.ad565eae.js"><link rel="prefetch" href="/linux-tutorial/assets/js/17.d43e9f56.js"><link rel="prefetch" href="/linux-tutorial/assets/js/18.aa00ff43.js"><link rel="prefetch" href="/linux-tutorial/assets/js/19.43ce44b3.js"><link rel="prefetch" href="/linux-tutorial/assets/js/20.5618e1ff.js"><link rel="prefetch" href="/linux-tutorial/assets/js/21.1c5a41d7.js"><link rel="prefetch" href="/linux-tutorial/assets/js/22.fbe9fdf1.js"><link rel="prefetch" href="/linux-tutorial/assets/js/23.a4fb0e74.js"><link rel="prefetch" href="/linux-tutorial/assets/js/24.e3a23b69.js"><link rel="prefetch" href="/linux-tutorial/assets/js/25.9896afe9.js"><link rel="prefetch" href="/linux-tutorial/assets/js/26.96164082.js"><link rel="prefetch" href="/linux-tutorial/assets/js/27.391033bb.js"><link rel="prefetch" href="/linux-tutorial/assets/js/28.703f74c2.js"><link rel="prefetch" href="/linux-tutorial/assets/js/29.02a952cb.js"><link rel="prefetch" href="/linux-tutorial/assets/js/30.7e13628f.js"><link rel="prefetch" href="/linux-tutorial/assets/js/31.c4652f75.js"><link rel="prefetch" href="/linux-tutorial/assets/js/32.05d2cbec.js"><link rel="prefetch" href="/linux-tutorial/assets/js/33.3b265df8.js"><link rel="prefetch" href="/linux-tutorial/assets/js/34.26330a03.js"><link rel="prefetch" href="/linux-tutorial/assets/js/35.417d706d.js"><link rel="prefetch" href="/linux-tutorial/assets/js/36.0ed775e0.js"><link rel="prefetch" href="/linux-tutorial/assets/js/37.34430c74.js"><link rel="prefetch" href="/linux-tutorial/assets/js/38.87d5e0ff.js"><link rel="prefetch" href="/linux-tutorial/assets/js/39.7b648b3e.js"><link rel="prefetch" href="/linux-tutorial/assets/js/40.3b7a219e.js"><link rel="prefetch" href="/linux-tutorial/assets/js/41.e727eee9.js"><link rel="prefetch" href="/linux-tutorial/assets/js/42.0134c187.js"><link rel="prefetch" href="/linux-tutorial/assets/js/43.175e982f.js"><link rel="prefetch" href="/linux-tutorial/assets/js/44.72d90888.js"><link rel="prefetch" href="/linux-tutorial/assets/js/46.a9c290ec.js"><link rel="prefetch" href="/linux-tutorial/assets/js/47.cc639f04.js"><link rel="prefetch" href="/linux-tutorial/assets/js/48.98c78321.js"><link rel="prefetch" href="/linux-tutorial/assets/js/49.a7c3afed.js"><link rel="prefetch" href="/linux-tutorial/assets/js/50.22d8c542.js"><link rel="prefetch" href="/linux-tutorial/assets/js/51.28055fcd.js"><link rel="prefetch" href="/linux-tutorial/assets/js/52.f8103df5.js"><link rel="prefetch" href="/linux-tutorial/assets/js/53.76541550.js"><link rel="prefetch" href="/linux-tutorial/assets/js/54.e78d2776.js"><link rel="prefetch" href="/linux-tutorial/assets/js/55.3ce3079c.js"><link rel="prefetch" href="/linux-tutorial/assets/js/56.832958c9.js"><link rel="prefetch" href="/linux-tutorial/assets/js/57.961ce896.js"><link rel="prefetch" href="/linux-tutorial/assets/js/58.6d6fbc82.js"><link rel="prefetch" href="/linux-tutorial/assets/js/59.d5e48112.js"><link rel="prefetch" href="/linux-tutorial/assets/js/6.c8f4721c.js"><link rel="prefetch" href="/linux-tutorial/assets/js/60.7927b23b.js"><link rel="prefetch" href="/linux-tutorial/assets/js/61.ee233f24.js"><link rel="prefetch" href="/linux-tutorial/assets/js/62.6ba50cc7.js"><link rel="prefetch" href="/linux-tutorial/assets/js/63.9cbf9f2b.js"><link rel="prefetch" href="/linux-tutorial/assets/js/64.0be148a4.js"><link rel="prefetch" href="/linux-tutorial/assets/js/65.c520257e.js"><link rel="prefetch" href="/linux-tutorial/assets/js/66.f2335390.js"><link rel="prefetch" href="/linux-tutorial/assets/js/67.e5737218.js"><link rel="prefetch" href="/linux-tutorial/assets/js/68.46427a01.js"><link rel="prefetch" href="/linux-tutorial/assets/js/69.450417bb.js"><link rel="prefetch" href="/linux-tutorial/assets/js/7.046e5a1b.js"><link rel="prefetch" href="/linux-tutorial/assets/js/70.072034d2.js"><link rel="prefetch" href="/linux-tutorial/assets/js/8.77fb8967.js"><link rel="prefetch" href="/linux-tutorial/assets/js/9.ebfa537e.js"><link rel="prefetch" href="/linux-tutorial/assets/js/vendors~flowchart.20a64d45.js"><link rel="prefetch" href="/linux-tutorial/assets/js/vendors~notification.ea176280.js">
    <link rel="stylesheet" href="/linux-tutorial/assets/css/0.styles.45d9d031.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/linux-tutorial/" class="home-link router-link-active"><img src="images/dunwu-logo-100.png" alt="LINUX-TUTORIAL" class="logo"> <span class="site-name can-hide">LINUX-TUTORIAL</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/linux-tutorial/linux/cli/" class="nav-link">
  Linux å‘½ä»¤
</a></div><div class="nav-item"><a href="/linux-tutorial/linux/ops/" class="nav-link router-link-active">
  Linux è¿ç»´
</a></div><div class="nav-item"><a href="/linux-tutorial/linux/soft/" class="nav-link">
  Linux è½¯ä»¶è¿ç»´
</a></div><div class="nav-item"><a href="/linux-tutorial/docker/" class="nav-link">
  Docker æ•™ç¨‹
</a></div><div class="nav-item"><a href="https://github.com/dunwu/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ğŸ¯ åšå®¢
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/dunwu/linux-tutorial" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/linux-tutorial/linux/cli/" class="nav-link">
  Linux å‘½ä»¤
</a></div><div class="nav-item"><a href="/linux-tutorial/linux/ops/" class="nav-link router-link-active">
  Linux è¿ç»´
</a></div><div class="nav-item"><a href="/linux-tutorial/linux/soft/" class="nav-link">
  Linux è½¯ä»¶è¿ç»´
</a></div><div class="nav-item"><a href="/linux-tutorial/docker/" class="nav-link">
  Docker æ•™ç¨‹
</a></div><div class="nav-item"><a href="https://github.com/dunwu/blog" target="_blank" rel="noopener noreferrer" class="nav-link external">
  ğŸ¯ åšå®¢
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/dunwu/linux-tutorial" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>Systemd åº”ç”¨</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/linux-tutorial/linux/ops/systemd.html#_1-ç”±æ¥" class="sidebar-link">1. ç”±æ¥</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/linux-tutorial/linux/ops/systemd.html#_2-systemd-æ¦‚è¿°" class="sidebar-link">2. Systemd æ¦‚è¿°</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/linux-tutorial/linux/ops/systemd.html#_3-ç³»ç»Ÿç®¡ç†" class="sidebar-link">3. ç³»ç»Ÿç®¡ç†</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/linux-tutorial/linux/ops/systemd.html#_3-1-systemctl" class="sidebar-link">3.1. systemctl</a></li><li class="sidebar-sub-header"><a href="/linux-tutorial/linux/ops/systemd.html#_3-2-systemd-analyze" class="sidebar-link">3.2. systemd-analyze</a></li><li class="sidebar-sub-header"><a href="/linux-tutorial/linux/ops/systemd.html#_3-3-hostnamectl" class="sidebar-link">3.3. hostnamectl</a></li><li class="sidebar-sub-header"><a href="/linux-tutorial/linux/ops/systemd.html#_3-4-localectl" class="sidebar-link">3.4. localectl</a></li><li class="sidebar-sub-header"><a href="/linux-tutorial/linux/ops/systemd.html#_3-5-timedatectl" class="sidebar-link">3.5. timedatectl</a></li><li class="sidebar-sub-header"><a href="/linux-tutorial/linux/ops/systemd.html#_3-6-loginctl" class="sidebar-link">3.6. loginctl</a></li></ul></li><li><a href="/linux-tutorial/linux/ops/systemd.html#_4-unit" class="sidebar-link">4. Unit</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/linux-tutorial/linux/ops/systemd.html#_4-1-å«ä¹‰" class="sidebar-link">4.1. å«ä¹‰</a></li><li class="sidebar-sub-header"><a href="/linux-tutorial/linux/ops/systemd.html#_4-2-unit-çš„çŠ¶æ€" class="sidebar-link">4.2. Unit çš„çŠ¶æ€</a></li><li class="sidebar-sub-header"><a href="/linux-tutorial/linux/ops/systemd.html#_4-3-unit-ç®¡ç†" class="sidebar-link">4.3. Unit ç®¡ç†</a></li><li class="sidebar-sub-header"><a href="/linux-tutorial/linux/ops/systemd.html#_4-4-ä¾èµ–å…³ç³»" class="sidebar-link">4.4. ä¾èµ–å…³ç³»</a></li></ul></li><li><a href="/linux-tutorial/linux/ops/systemd.html#_5-unit-çš„é…ç½®æ–‡ä»¶" class="sidebar-link">5. Unit çš„é…ç½®æ–‡ä»¶</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/linux-tutorial/linux/ops/systemd.html#_5-1-æ¦‚è¿°" class="sidebar-link">5.1. æ¦‚è¿°</a></li><li class="sidebar-sub-header"><a href="/linux-tutorial/linux/ops/systemd.html#_5-2-é…ç½®æ–‡ä»¶çš„çŠ¶æ€" class="sidebar-link">5.2. é…ç½®æ–‡ä»¶çš„çŠ¶æ€</a></li><li class="sidebar-sub-header"><a href="/linux-tutorial/linux/ops/systemd.html#_5-3-é…ç½®æ–‡ä»¶çš„æ ¼å¼" class="sidebar-link">5.3. é…ç½®æ–‡ä»¶çš„æ ¼å¼</a></li><li class="sidebar-sub-header"><a href="/linux-tutorial/linux/ops/systemd.html#_5-4-é…ç½®æ–‡ä»¶çš„åŒºå—" class="sidebar-link">5.4. é…ç½®æ–‡ä»¶çš„åŒºå—</a></li></ul></li><li><a href="/linux-tutorial/linux/ops/systemd.html#_6-target" class="sidebar-link">6. Target</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/linux-tutorial/linux/ops/systemd.html#_7-æ—¥å¿—ç®¡ç†" class="sidebar-link">7. æ—¥å¿—ç®¡ç†</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/linux-tutorial/linux/ops/systemd.html#_8-å®æˆ˜" class="sidebar-link">8. å®æˆ˜</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/linux-tutorial/linux/ops/systemd.html#_8-1-å¼€æœºå¯åŠ¨" class="sidebar-link">8.1. å¼€æœºå¯åŠ¨</a></li><li class="sidebar-sub-header"><a href="/linux-tutorial/linux/ops/systemd.html#_8-2-å¯åŠ¨æœåŠ¡" class="sidebar-link">8.2. å¯åŠ¨æœåŠ¡</a></li><li class="sidebar-sub-header"><a href="/linux-tutorial/linux/ops/systemd.html#_8-3-åœæ­¢æœåŠ¡" class="sidebar-link">8.3. åœæ­¢æœåŠ¡</a></li><li class="sidebar-sub-header"><a href="/linux-tutorial/linux/ops/systemd.html#_8-4-è¯»æ‡‚é…ç½®æ–‡ä»¶" class="sidebar-link">8.4. è¯»æ‡‚é…ç½®æ–‡ä»¶</a></li><li class="sidebar-sub-header"><a href="/linux-tutorial/linux/ops/systemd.html#_8-5-unit-åŒºå—-å¯åŠ¨é¡ºåºä¸ä¾èµ–å…³ç³»ã€‚" class="sidebar-link">8.5. [Unit] åŒºå—ï¼šå¯åŠ¨é¡ºåºä¸ä¾èµ–å…³ç³»ã€‚</a></li><li class="sidebar-sub-header"><a href="/linux-tutorial/linux/ops/systemd.html#_8-6-service-åŒºå—-å¯åŠ¨è¡Œä¸º" class="sidebar-link">8.6. [Service] åŒºå—ï¼šå¯åŠ¨è¡Œä¸º</a></li><li class="sidebar-sub-header"><a href="/linux-tutorial/linux/ops/systemd.html#_8-7-install-åŒºå—" class="sidebar-link">8.7. [Install] åŒºå—</a></li><li class="sidebar-sub-header"><a href="/linux-tutorial/linux/ops/systemd.html#_8-8-target-çš„é…ç½®æ–‡ä»¶" class="sidebar-link">8.8. Target çš„é…ç½®æ–‡ä»¶</a></li><li class="sidebar-sub-header"><a href="/linux-tutorial/linux/ops/systemd.html#_8-9-ä¿®æ”¹é…ç½®æ–‡ä»¶åé‡å¯" class="sidebar-link">8.9. ä¿®æ”¹é…ç½®æ–‡ä»¶åé‡å¯</a></li></ul></li><li><a href="/linux-tutorial/linux/ops/systemd.html#_9-å‚è€ƒèµ„æ–™" class="sidebar-link">9. å‚è€ƒèµ„æ–™</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="systemd-åº”ç”¨"><a href="#systemd-åº”ç”¨" class="header-anchor">#</a> Systemd åº”ç”¨</h1> <blockquote><p>æ¬è¿è‡ªï¼š<a href="http://www.ruanyifeng.com/blog/2016/03/systemd-tutorial-commands.html" target="_blank" rel="noopener noreferrer">Systemd å…¥é—¨æ•™ç¨‹ï¼šå‘½ä»¤ç¯‡<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã€<a href="/linux-tutorial/linux/ops/hhttp:/www.ruanyifeng.com/blog/2016/03/systemd-tutorial-part-two.html">Systemd å…¥é—¨æ•™ç¨‹ï¼šå®æˆ˜ç¯‡</a></p></blockquote> <p>Systemd æ˜¯ Linux ç³»ç»Ÿå·¥å…·ï¼Œç”¨æ¥å¯åŠ¨<a href="http://www.ruanyifeng.com/blog/2016/02/linux-daemon.html" target="_blank" rel="noopener noreferrer">å®ˆæŠ¤è¿›ç¨‹<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ï¼Œå·²æˆä¸ºå¤§å¤šæ•°å‘è¡Œç‰ˆçš„æ ‡å‡†é…ç½®ã€‚</p> <p>æœ¬æ–‡ä»‹ç»å®ƒçš„åŸºæœ¬ç”¨æ³•ï¼Œåˆ†ä¸ºä¸Šä¸‹ä¸¤ç¯‡ã€‚ä»Šå¤©ä»‹ç»å®ƒçš„ä¸»è¦å‘½ä»¤ï¼Œ<a href="http://www.ruanyifeng.com/blog/2016/03/systemd-tutorial-part-two.html" target="_blank" rel="noopener noreferrer">ä¸‹ä¸€ç¯‡<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ä»‹ç»å¦‚ä½•ç”¨äºå®æˆ˜ã€‚</p> <h2 id="_1-ç”±æ¥"><a href="#_1-ç”±æ¥" class="header-anchor">#</a> 1. ç”±æ¥</h2> <p>å†å²ä¸Šï¼Œ<a href="http://www.ruanyifeng.com/blog/2013/08/linux_boot_process.html" target="_blank" rel="noopener noreferrer">Linux çš„å¯åŠ¨<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ä¸€ç›´é‡‡ç”¨<a href="https://en.wikipedia.org/wiki/Init" target="_blank" rel="noopener noreferrer"><code>init</code><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>è¿›ç¨‹ã€‚</p> <p>ä¸‹é¢çš„å‘½ä»¤ç”¨æ¥å¯åŠ¨æœåŠ¡ã€‚</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">sudo</span> /etc/init.d/apache2 start
<span class="token comment"># æˆ–è€…</span>
$ <span class="token function">service</span> apache2 start
</code></pre></div><p>è¿™ç§æ–¹æ³•æœ‰ä¸¤ä¸ªç¼ºç‚¹ã€‚</p> <p>ä¸€æ˜¯å¯åŠ¨æ—¶é—´é•¿ã€‚<code>init</code>è¿›ç¨‹æ˜¯ä¸²è¡Œå¯åŠ¨ï¼Œåªæœ‰å‰ä¸€ä¸ªè¿›ç¨‹å¯åŠ¨å®Œï¼Œæ‰ä¼šå¯åŠ¨ä¸‹ä¸€ä¸ªè¿›ç¨‹ã€‚</p> <p>äºŒæ˜¯å¯åŠ¨è„šæœ¬å¤æ‚ã€‚<code>init</code>è¿›ç¨‹åªæ˜¯æ‰§è¡Œå¯åŠ¨è„šæœ¬ï¼Œä¸ç®¡å…¶ä»–äº‹æƒ…ã€‚è„šæœ¬éœ€è¦è‡ªå·±å¤„ç†å„ç§
æƒ…å†µï¼Œè¿™å¾€å¾€ä½¿å¾—è„šæœ¬å˜å¾—å¾ˆé•¿ã€‚</p> <h2 id="_2-systemd-æ¦‚è¿°"><a href="#_2-systemd-æ¦‚è¿°" class="header-anchor">#</a> 2. Systemd æ¦‚è¿°</h2> <p>Systemd å°±æ˜¯ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜è€Œè¯ç”Ÿçš„ã€‚å®ƒçš„è®¾è®¡ç›®æ ‡æ˜¯ï¼Œä¸ºç³»ç»Ÿçš„å¯åŠ¨å’Œç®¡ç†æä¾›ä¸€å¥—
å®Œæ•´çš„è§£å†³æ–¹æ¡ˆã€‚</p> <p>æ ¹æ® Linux æƒ¯ä¾‹ï¼Œå­—æ¯<code>d</code>æ˜¯å®ˆæŠ¤è¿›ç¨‹ï¼ˆdaemonï¼‰çš„ç¼©å†™ã€‚ Systemd è¿™ä¸ªåå­—çš„å«ä¹‰ï¼Œå°±
æ˜¯å®ƒè¦å®ˆæŠ¤æ•´ä¸ªç³»ç»Ÿã€‚</p> <p>ä½¿ç”¨äº† Systemdï¼Œå°±ä¸éœ€è¦å†ç”¨<code>init</code>äº†ã€‚Systemd å–ä»£äº†<code>initd</code>ï¼Œæˆä¸ºç³»ç»Ÿçš„ç¬¬ä¸€ä¸ªè¿›
ç¨‹ï¼ˆPID ç­‰äº 1ï¼‰ï¼Œå…¶ä»–è¿›ç¨‹éƒ½æ˜¯å®ƒçš„å­è¿›ç¨‹ã€‚</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ systemctl --version
</code></pre></div><p>ä¸Šé¢çš„å‘½ä»¤æŸ¥çœ‹ Systemd çš„ç‰ˆæœ¬ã€‚</p> <p>Systemd çš„ä¼˜ç‚¹æ˜¯åŠŸèƒ½å¼ºå¤§ï¼Œä½¿ç”¨æ–¹ä¾¿ï¼Œç¼ºç‚¹æ˜¯ä½“ç³»åºå¤§ï¼Œéå¸¸å¤æ‚ã€‚äº‹å®ä¸Šï¼Œç°åœ¨è¿˜æœ‰å¾ˆ
å¤šäººåå¯¹ä½¿ç”¨ Systemdï¼Œç†ç”±å°±æ˜¯å®ƒè¿‡äºå¤æ‚ï¼Œä¸æ“ä½œç³»ç»Ÿçš„å…¶ä»–éƒ¨åˆ†å¼ºè€¦åˆï¼Œè¿å&quot;keep
simple, keep stupid&quot;
çš„<a href="http://www.ruanyifeng.com/blog/2009/06/unix_philosophy.html" target="_blank" rel="noopener noreferrer">Unix å“²å­¦<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã€‚</p> <p><img src="http://www.ruanyifeng.com/blogimg/asset/2016/bg2016030703.png" alt="img"></p> <p>ï¼ˆä¸Šå›¾ä¸º Systemd æ¶æ„å›¾ï¼‰</p> <h2 id="_3-ç³»ç»Ÿç®¡ç†"><a href="#_3-ç³»ç»Ÿç®¡ç†" class="header-anchor">#</a> 3. ç³»ç»Ÿç®¡ç†</h2> <p>Systemd å¹¶ä¸æ˜¯ä¸€ä¸ªå‘½ä»¤ï¼Œè€Œæ˜¯ä¸€ç»„å‘½ä»¤ï¼Œæ¶‰åŠåˆ°ç³»ç»Ÿç®¡ç†çš„æ–¹æ–¹é¢é¢ã€‚</p> <h3 id="_3-1-systemctl"><a href="#_3-1-systemctl" class="header-anchor">#</a> 3.1. systemctl</h3> <p><code>systemctl</code>æ˜¯ Systemd çš„ä¸»å‘½ä»¤ï¼Œç”¨äºç®¡ç†ç³»ç»Ÿã€‚</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># é‡å¯ç³»ç»Ÿ</span>
$ <span class="token function">sudo</span> systemctl <span class="token function">reboot</span>

<span class="token comment"># å…³é—­ç³»ç»Ÿï¼Œåˆ‡æ–­ç”µæº</span>
$ <span class="token function">sudo</span> systemctl poweroff

<span class="token comment"># CPUåœæ­¢å·¥ä½œ</span>
$ <span class="token function">sudo</span> systemctl <span class="token function">halt</span>

<span class="token comment"># æš‚åœç³»ç»Ÿ</span>
$ <span class="token function">sudo</span> systemctl <span class="token function">suspend</span>

<span class="token comment"># è®©ç³»ç»Ÿè¿›å…¥å†¬çœ çŠ¶æ€</span>
$ <span class="token function">sudo</span> systemctl hibernate

<span class="token comment"># è®©ç³»ç»Ÿè¿›å…¥äº¤äº’å¼ä¼‘çœ çŠ¶æ€</span>
$ <span class="token function">sudo</span> systemctl hybrid-sleep

<span class="token comment"># å¯åŠ¨è¿›å…¥æ•‘æ´çŠ¶æ€ï¼ˆå•ç”¨æˆ·çŠ¶æ€ï¼‰</span>
$ <span class="token function">sudo</span> systemctl rescue
</code></pre></div><h3 id="_3-2-systemd-analyze"><a href="#_3-2-systemd-analyze" class="header-anchor">#</a> 3.2. systemd-analyze</h3> <p><code>systemd-analyze</code>å‘½ä»¤ç”¨äºæŸ¥çœ‹å¯åŠ¨è€—æ—¶ã€‚</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># æŸ¥çœ‹å¯åŠ¨è€—æ—¶</span>
$ systemd-analyze

<span class="token comment"># æŸ¥çœ‹æ¯ä¸ªæœåŠ¡çš„å¯åŠ¨è€—æ—¶</span>
$ systemd-analyze blame

<span class="token comment"># æ˜¾ç¤ºç€‘å¸ƒçŠ¶çš„å¯åŠ¨è¿‡ç¨‹æµ</span>
$ systemd-analyze critical-chain

<span class="token comment"># æ˜¾ç¤ºæŒ‡å®šæœåŠ¡çš„å¯åŠ¨æµ</span>
$ systemd-analyze critical-chain atd.service
</code></pre></div><h3 id="_3-3-hostnamectl"><a href="#_3-3-hostnamectl" class="header-anchor">#</a> 3.3. hostnamectl</h3> <p><code>hostnamectl</code>å‘½ä»¤ç”¨äºæŸ¥çœ‹å½“å‰ä¸»æœºçš„ä¿¡æ¯ã€‚</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># æ˜¾ç¤ºå½“å‰ä¸»æœºçš„ä¿¡æ¯</span>
$ hostnamectl

<span class="token comment"># è®¾ç½®ä¸»æœºåã€‚</span>
$ <span class="token function">sudo</span> hostnamectl set-hostname rhel7
</code></pre></div><h3 id="_3-4-localectl"><a href="#_3-4-localectl" class="header-anchor">#</a> 3.4. localectl</h3> <p><code>localectl</code>å‘½ä»¤ç”¨äºæŸ¥çœ‹æœ¬åœ°åŒ–è®¾ç½®ã€‚</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># æŸ¥çœ‹æœ¬åœ°åŒ–è®¾ç½®</span>
$ localectl

<span class="token comment"># è®¾ç½®æœ¬åœ°åŒ–å‚æ•°ã€‚</span>
$ <span class="token function">sudo</span> localectl set-locale <span class="token assign-left variable"><span class="token environment constant">LANG</span></span><span class="token operator">=</span>en_GB.utf8
$ <span class="token function">sudo</span> localectl set-keymap en_GB
</code></pre></div><h3 id="_3-5-timedatectl"><a href="#_3-5-timedatectl" class="header-anchor">#</a> 3.5. timedatectl</h3> <p><code>timedatectl</code>å‘½ä»¤ç”¨äºæŸ¥çœ‹å½“å‰æ—¶åŒºè®¾ç½®ã€‚</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># æŸ¥çœ‹å½“å‰æ—¶åŒºè®¾ç½®</span>
$ timedatectl

<span class="token comment"># æ˜¾ç¤ºæ‰€æœ‰å¯ç”¨çš„æ—¶åŒº</span>
$ timedatectl list-timezones

<span class="token comment"># è®¾ç½®å½“å‰æ—¶åŒº</span>
$ <span class="token function">sudo</span> timedatectl set-timezone America/New_York
$ <span class="token function">sudo</span> timedatectl set-time YYYY-MM-DD
$ <span class="token function">sudo</span> timedatectl set-time HH:MM:SS
</code></pre></div><h3 id="_3-6-loginctl"><a href="#_3-6-loginctl" class="header-anchor">#</a> 3.6. loginctl</h3> <p><code>loginctl</code>å‘½ä»¤ç”¨äºæŸ¥çœ‹å½“å‰ç™»å½•çš„ç”¨æˆ·ã€‚</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># åˆ—å‡ºå½“å‰session</span>
$ loginctl list-sessions

<span class="token comment"># åˆ—å‡ºå½“å‰ç™»å½•ç”¨æˆ·</span>
$ loginctl list-users

<span class="token comment"># åˆ—å‡ºæ˜¾ç¤ºæŒ‡å®šç”¨æˆ·çš„ä¿¡æ¯</span>
$ loginctl show-user ruanyf
</code></pre></div><h2 id="_4-unit"><a href="#_4-unit" class="header-anchor">#</a> 4. Unit</h2> <h3 id="_4-1-å«ä¹‰"><a href="#_4-1-å«ä¹‰" class="header-anchor">#</a> 4.1. å«ä¹‰</h3> <p>Systemd å¯ä»¥ç®¡ç†æ‰€æœ‰ç³»ç»Ÿèµ„æºã€‚ä¸åŒçš„èµ„æºç»Ÿç§°ä¸º Unitï¼ˆå•ä½ï¼‰ã€‚</p> <p>Unit ä¸€å…±åˆ†æˆ 12 ç§ã€‚</p> <ul><li>Service unitï¼šç³»ç»ŸæœåŠ¡</li> <li>Target unitï¼šå¤šä¸ª Unit æ„æˆçš„ä¸€ä¸ªç»„</li> <li>Device Unitï¼šç¡¬ä»¶è®¾å¤‡</li> <li>Mount Unitï¼šæ–‡ä»¶ç³»ç»Ÿçš„æŒ‚è½½ç‚¹</li> <li>Automount Unitï¼šè‡ªåŠ¨æŒ‚è½½ç‚¹</li> <li>Path Unitï¼šæ–‡ä»¶æˆ–è·¯å¾„</li> <li>Scope Unitï¼šä¸æ˜¯ç”± Systemd å¯åŠ¨çš„å¤–éƒ¨è¿›ç¨‹</li> <li>Slice Unitï¼šè¿›ç¨‹ç»„</li> <li>Snapshot Unitï¼šSystemd å¿«ç…§ï¼Œå¯ä»¥åˆ‡å›æŸä¸ªå¿«ç…§</li> <li>Socket Unitï¼šè¿›ç¨‹é—´é€šä¿¡çš„ socket</li> <li>Swap Unitï¼šswap æ–‡ä»¶</li> <li>Timer Unitï¼šå®šæ—¶å™¨</li></ul> <p><code>systemctl list-units</code>å‘½ä»¤å¯ä»¥æŸ¥çœ‹å½“å‰ç³»ç»Ÿçš„æ‰€æœ‰ Unit ã€‚</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># åˆ—å‡ºæ­£åœ¨è¿è¡Œçš„ Unit</span>
$ systemctl list-units

<span class="token comment"># åˆ—å‡ºæ‰€æœ‰Unitï¼ŒåŒ…æ‹¬æ²¡æœ‰æ‰¾åˆ°é…ç½®æ–‡ä»¶çš„æˆ–è€…å¯åŠ¨å¤±è´¥çš„</span>
$ systemctl list-units --all

<span class="token comment"># åˆ—å‡ºæ‰€æœ‰æ²¡æœ‰è¿è¡Œçš„ Unit</span>
$ systemctl list-units --all --state<span class="token operator">=</span>inactive

<span class="token comment"># åˆ—å‡ºæ‰€æœ‰åŠ è½½å¤±è´¥çš„ Unit</span>
$ systemctl list-units --failed

<span class="token comment"># åˆ—å‡ºæ‰€æœ‰æ­£åœ¨è¿è¡Œçš„ã€ç±»å‹ä¸º service çš„ Unit</span>
$ systemctl list-units --type<span class="token operator">=</span>service
</code></pre></div><h3 id="_4-2-unit-çš„çŠ¶æ€"><a href="#_4-2-unit-çš„çŠ¶æ€" class="header-anchor">#</a> 4.2. Unit çš„çŠ¶æ€</h3> <p><code>systemctl status</code>å‘½ä»¤ç”¨äºæŸ¥çœ‹ç³»ç»ŸçŠ¶æ€å’Œå•ä¸ª Unit çš„çŠ¶æ€ã€‚</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># æ˜¾ç¤ºç³»ç»ŸçŠ¶æ€</span>
$ systemctl status

<span class="token comment"># æ˜¾ç¤ºå•ä¸ª Unit çš„çŠ¶æ€</span>
$ sysystemctl status bluetooth.service

<span class="token comment"># æ˜¾ç¤ºè¿œç¨‹ä¸»æœºçš„æŸä¸ª Unit çš„çŠ¶æ€</span>
$ systemctl -H root@rhel7.example.com status httpd.service
</code></pre></div><p>é™¤äº†<code>status</code>å‘½ä»¤ï¼Œ<code>systemctl</code>è¿˜æä¾›äº†ä¸‰ä¸ªæŸ¥è¯¢çŠ¶æ€çš„ç®€å•æ–¹æ³•ï¼Œä¸»è¦ä¾›è„šæœ¬å†…éƒ¨çš„åˆ¤
æ–­è¯­å¥ä½¿ç”¨ã€‚</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># æ˜¾ç¤ºæŸä¸ª Unit æ˜¯å¦æ­£åœ¨è¿è¡Œ</span>
$ systemctl is-active application.service

<span class="token comment"># æ˜¾ç¤ºæŸä¸ª Unit æ˜¯å¦å¤„äºå¯åŠ¨å¤±è´¥çŠ¶æ€</span>
$ systemctl is-failed application.service

<span class="token comment"># æ˜¾ç¤ºæŸä¸ª Unit æœåŠ¡æ˜¯å¦å»ºç«‹äº†å¯åŠ¨é“¾æ¥</span>
$ systemctl is-enabled application.service
</code></pre></div><h3 id="_4-3-unit-ç®¡ç†"><a href="#_4-3-unit-ç®¡ç†" class="header-anchor">#</a> 4.3. Unit ç®¡ç†</h3> <p>å¯¹äºç”¨æˆ·æ¥è¯´ï¼Œæœ€å¸¸ç”¨çš„æ˜¯ä¸‹é¢è¿™äº›å‘½ä»¤ï¼Œç”¨äºå¯åŠ¨å’Œåœæ­¢ Unitï¼ˆä¸»è¦æ˜¯ serviceï¼‰ã€‚</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># ç«‹å³å¯åŠ¨ä¸€ä¸ªæœåŠ¡</span>
$ <span class="token function">sudo</span> systemctl start apache.service

<span class="token comment"># ç«‹å³åœæ­¢ä¸€ä¸ªæœåŠ¡</span>
$ <span class="token function">sudo</span> systemctl stop apache.service

<span class="token comment"># é‡å¯ä¸€ä¸ªæœåŠ¡</span>
$ <span class="token function">sudo</span> systemctl restart apache.service

<span class="token comment"># æ€æ­»ä¸€ä¸ªæœåŠ¡çš„æ‰€æœ‰å­è¿›ç¨‹</span>
$ <span class="token function">sudo</span> systemctl <span class="token function">kill</span> apache.service

<span class="token comment"># é‡æ–°åŠ è½½ä¸€ä¸ªæœåŠ¡çš„é…ç½®æ–‡ä»¶</span>
$ <span class="token function">sudo</span> systemctl reload apache.service

<span class="token comment"># é‡è½½æ‰€æœ‰ä¿®æ”¹è¿‡çš„é…ç½®æ–‡ä»¶</span>
$ <span class="token function">sudo</span> systemctl daemon-reload

<span class="token comment"># æ˜¾ç¤ºæŸä¸ª Unit çš„æ‰€æœ‰åº•å±‚å‚æ•°</span>
$ systemctl show httpd.service

<span class="token comment"># æ˜¾ç¤ºæŸä¸ª Unit çš„æŒ‡å®šå±æ€§çš„å€¼</span>
$ systemctl show -p CPUShares httpd.service

<span class="token comment"># è®¾ç½®æŸä¸ª Unit çš„æŒ‡å®šå±æ€§</span>
$ <span class="token function">sudo</span> systemctl set-property httpd.service <span class="token assign-left variable">CPUShares</span><span class="token operator">=</span><span class="token number">500</span>
</code></pre></div><h3 id="_4-4-ä¾èµ–å…³ç³»"><a href="#_4-4-ä¾èµ–å…³ç³»" class="header-anchor">#</a> 4.4. ä¾èµ–å…³ç³»</h3> <p>Unit ä¹‹é—´å­˜åœ¨ä¾èµ–å…³ç³»ï¼šA ä¾èµ–äº Bï¼Œå°±æ„å‘³ç€ Systemd åœ¨å¯åŠ¨ A çš„æ—¶å€™ï¼ŒåŒæ—¶ä¼šå»å¯
åŠ¨ Bã€‚</p> <p><code>systemctl list-dependencies</code>å‘½ä»¤åˆ—å‡ºä¸€ä¸ª Unit çš„æ‰€æœ‰ä¾èµ–ã€‚</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ systemctl list-dependencies nginx.service
</code></pre></div><p>ä¸Šé¢å‘½ä»¤çš„è¾“å‡ºç»“æœä¹‹ä¸­ï¼Œæœ‰äº›ä¾èµ–æ˜¯ Target ç±»å‹ï¼ˆè¯¦è§ä¸‹æ–‡ï¼‰ï¼Œé»˜è®¤ä¸ä¼šå±•å¼€æ˜¾ç¤ºã€‚å¦‚
æœè¦å±•å¼€ Targetï¼Œå°±éœ€è¦ä½¿ç”¨<code>--all</code>å‚æ•°ã€‚</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ systemctl list-dependencies --all nginx.service
</code></pre></div><h2 id="_5-unit-çš„é…ç½®æ–‡ä»¶"><a href="#_5-unit-çš„é…ç½®æ–‡ä»¶" class="header-anchor">#</a> 5. Unit çš„é…ç½®æ–‡ä»¶</h2> <h3 id="_5-1-æ¦‚è¿°"><a href="#_5-1-æ¦‚è¿°" class="header-anchor">#</a> 5.1. æ¦‚è¿°</h3> <p>æ¯ä¸€ä¸ª Unit éƒ½æœ‰ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå‘Šè¯‰ Systemd æ€ä¹ˆå¯åŠ¨è¿™ä¸ª Unit ã€‚</p> <p>Systemd é»˜è®¤ä»ç›®å½•<code>/etc/systemd/system/</code>è¯»å–é…ç½®æ–‡ä»¶ã€‚ä½†æ˜¯ï¼Œé‡Œé¢å­˜æ”¾çš„å¤§éƒ¨åˆ†æ–‡ä»¶
éƒ½æ˜¯ç¬¦å·é“¾æ¥ï¼ŒæŒ‡å‘ç›®å½•<code>/usr/lib/systemd/system/</code>ï¼ŒçœŸæ­£çš„é…ç½®æ–‡ä»¶å­˜æ”¾åœ¨é‚£ä¸ªç›®å½•ã€‚</p> <p><code>systemctl enable</code>å‘½ä»¤ç”¨äºåœ¨ä¸Šé¢ä¸¤ä¸ªç›®å½•ä¹‹é—´ï¼Œå»ºç«‹ç¬¦å·é“¾æ¥å…³ç³»ã€‚</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> clamd@scan.service
<span class="token comment"># ç­‰åŒäº</span>
$ <span class="token function">sudo</span> <span class="token function">ln</span> -s <span class="token string">'/usr/lib/systemd/system/clamd@scan.service'</span> <span class="token string">'/etc/systemd/system/multi-user.target.wants/clamd@scan.service'</span>
</code></pre></div><p>å¦‚æœé…ç½®æ–‡ä»¶é‡Œé¢è®¾ç½®äº†å¼€æœºå¯åŠ¨ï¼Œ<code>systemctl enable</code>å‘½ä»¤ç›¸å½“äºæ¿€æ´»å¼€æœºå¯åŠ¨ã€‚</p> <p>ä¸ä¹‹å¯¹åº”çš„ï¼Œ<code>systemctl disable</code>å‘½ä»¤ç”¨äºåœ¨ä¸¤ä¸ªç›®å½•ä¹‹é—´ï¼Œæ’¤é”€ç¬¦å·é“¾æ¥å…³ç³»ï¼Œç›¸å½“äº
æ’¤é”€å¼€æœºå¯åŠ¨ã€‚</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">sudo</span> systemctl disable clamd@scan.service
</code></pre></div><p>é…ç½®æ–‡ä»¶çš„åç¼€åï¼Œå°±æ˜¯è¯¥ Unit çš„ç§ç±»ï¼Œæ¯”å¦‚<code>sshd.socket</code>ã€‚å¦‚æœçœç•¥ï¼ŒSystemd é»˜è®¤
åç¼€åä¸º<code>.service</code>ï¼Œæ‰€ä»¥<code>sshd</code>ä¼šè¢«ç†è§£æˆ<code>sshd.service</code>ã€‚</p> <h3 id="_5-2-é…ç½®æ–‡ä»¶çš„çŠ¶æ€"><a href="#_5-2-é…ç½®æ–‡ä»¶çš„çŠ¶æ€" class="header-anchor">#</a> 5.2. é…ç½®æ–‡ä»¶çš„çŠ¶æ€</h3> <p><code>systemctl list-unit-files</code>å‘½ä»¤ç”¨äºåˆ—å‡ºæ‰€æœ‰é…ç½®æ–‡ä»¶ã€‚</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># åˆ—å‡ºæ‰€æœ‰é…ç½®æ–‡ä»¶</span>
$ systemctl list-unit-files

<span class="token comment"># åˆ—å‡ºæŒ‡å®šç±»å‹çš„é…ç½®æ–‡ä»¶</span>
$ systemctl list-unit-files --type<span class="token operator">=</span>service
</code></pre></div><p>è¿™ä¸ªå‘½ä»¤ä¼šè¾“å‡ºä¸€ä¸ªåˆ—è¡¨ã€‚</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ systemctl list-unit-files

UNIT FILE              STATE
chronyd.service        enabled
clamd@.service         static
clamd@scan.service     disabled
</code></pre></div><p>è¿™ä¸ªåˆ—è¡¨æ˜¾ç¤ºæ¯ä¸ªé…ç½®æ–‡ä»¶çš„çŠ¶æ€ï¼Œä¸€å…±æœ‰å››ç§ã€‚</p> <ul><li>enabledï¼šå·²å»ºç«‹å¯åŠ¨é“¾æ¥</li> <li>disabledï¼šæ²¡å»ºç«‹å¯åŠ¨é“¾æ¥</li> <li>staticï¼šè¯¥é…ç½®æ–‡ä»¶æ²¡æœ‰<code>[Install]</code>éƒ¨åˆ†ï¼ˆæ— æ³•æ‰§è¡Œï¼‰ï¼Œåªèƒ½ä½œä¸ºå…¶ä»–é…ç½®æ–‡ä»¶çš„ä¾èµ–</li> <li>maskedï¼šè¯¥é…ç½®æ–‡ä»¶è¢«ç¦æ­¢å»ºç«‹å¯åŠ¨é“¾æ¥</li></ul> <p>æ³¨æ„ï¼Œä»é…ç½®æ–‡ä»¶çš„çŠ¶æ€æ— æ³•çœ‹å‡ºï¼Œè¯¥ Unit æ˜¯å¦æ­£åœ¨è¿è¡Œã€‚è¿™å¿…é¡»æ‰§è¡Œå‰é¢æåˆ°
çš„<code>systemctl status</code>å‘½ä»¤ã€‚</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ systemctl status bluetooth.service
</code></pre></div><p>ä¸€æ—¦ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œå°±è¦è®© SystemD é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶ï¼Œç„¶åé‡æ–°å¯åŠ¨ï¼Œå¦åˆ™ä¿®æ”¹ä¸ä¼šç”Ÿ
æ•ˆã€‚</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">sudo</span> systemctl daemon-reload
$ <span class="token function">sudo</span> systemctl restart httpd.service
</code></pre></div><h3 id="_5-3-é…ç½®æ–‡ä»¶çš„æ ¼å¼"><a href="#_5-3-é…ç½®æ–‡ä»¶çš„æ ¼å¼" class="header-anchor">#</a> 5.3. é…ç½®æ–‡ä»¶çš„æ ¼å¼</h3> <p>é…ç½®æ–‡ä»¶å°±æ˜¯æ™®é€šçš„æ–‡æœ¬æ–‡ä»¶ï¼Œå¯ä»¥ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€ã€‚</p> <p><code>systemctl cat</code>å‘½ä»¤å¯ä»¥æŸ¥çœ‹é…ç½®æ–‡ä»¶çš„å†…å®¹ã€‚</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ systemctl <span class="token function">cat</span> atd.service

<span class="token punctuation">[</span>Unit<span class="token punctuation">]</span>
<span class="token assign-left variable">Description</span><span class="token operator">=</span>ATD daemon

<span class="token punctuation">[</span>Service<span class="token punctuation">]</span>
<span class="token assign-left variable">Type</span><span class="token operator">=</span>forking
<span class="token assign-left variable">ExecStart</span><span class="token operator">=</span>/usr/bin/atd

<span class="token punctuation">[</span>Install<span class="token punctuation">]</span>
<span class="token assign-left variable">WantedBy</span><span class="token operator">=</span>multi-user.target
</code></pre></div><p>ä»ä¸Šé¢çš„è¾“å‡ºå¯ä»¥çœ‹åˆ°ï¼Œé…ç½®æ–‡ä»¶åˆ†æˆå‡ ä¸ªåŒºå—ã€‚æ¯ä¸ªåŒºå—çš„ç¬¬ä¸€è¡Œï¼Œæ˜¯ç”¨æ–¹æ‹¬å·è¡¨ç¤ºçš„åŒº
åˆ«åï¼Œæ¯”å¦‚<code>[Unit]</code>ã€‚æ³¨æ„ï¼Œé…ç½®æ–‡ä»¶çš„åŒºå—åå’Œå­—æ®µåï¼Œéƒ½æ˜¯å¤§å°å†™æ•æ„Ÿçš„ã€‚</p> <p>æ¯ä¸ªåŒºå—å†…éƒ¨æ˜¯ä¸€äº›ç­‰å·è¿æ¥çš„é”®å€¼å¯¹ã€‚</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">[</span>Section<span class="token punctuation">]</span>
<span class="token assign-left variable">Directive1</span><span class="token operator">=</span>value
<span class="token assign-left variable">Directive2</span><span class="token operator">=</span>value

<span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span> <span class="token builtin class-name">.</span>
</code></pre></div><p>æ³¨æ„ï¼Œé”®å€¼å¯¹çš„ç­‰å·ä¸¤ä¾§ä¸èƒ½æœ‰ç©ºæ ¼ã€‚</p> <h3 id="_5-4-é…ç½®æ–‡ä»¶çš„åŒºå—"><a href="#_5-4-é…ç½®æ–‡ä»¶çš„åŒºå—" class="header-anchor">#</a> 5.4. é…ç½®æ–‡ä»¶çš„åŒºå—</h3> <p><code>[Unit]</code>åŒºå—é€šå¸¸æ˜¯é…ç½®æ–‡ä»¶çš„ç¬¬ä¸€ä¸ªåŒºå—ï¼Œç”¨æ¥å®šä¹‰ Unit çš„å…ƒæ•°æ®ï¼Œä»¥åŠé…ç½®ä¸å…¶ä»–
Unit çš„å…³ç³»ã€‚å®ƒçš„ä¸»è¦å­—æ®µå¦‚ä¸‹ã€‚</p> <ul><li><code>Description</code>ï¼šç®€çŸ­æè¿°</li> <li><code>Documentation</code>ï¼šæ–‡æ¡£åœ°å€</li> <li><code>Requires</code>ï¼šå½“å‰ Unit ä¾èµ–çš„å…¶ä»– Unitï¼Œå¦‚æœå®ƒä»¬æ²¡æœ‰è¿è¡Œï¼Œå½“å‰ Unit ä¼šå¯åŠ¨å¤±è´¥</li> <li><code>Wants</code>ï¼šä¸å½“å‰ Unit é…åˆçš„å…¶ä»– Unitï¼Œå¦‚æœå®ƒä»¬æ²¡æœ‰è¿è¡Œï¼Œå½“å‰ Unit ä¸ä¼šå¯åŠ¨å¤±è´¥</li> <li><code>BindsTo</code>ï¼šä¸<code>Requires</code>ç±»ä¼¼ï¼Œå®ƒæŒ‡å®šçš„ Unit å¦‚æœé€€å‡ºï¼Œä¼šå¯¼è‡´å½“å‰ Unit åœæ­¢è¿è¡Œ</li> <li><code>Before</code>ï¼šå¦‚æœè¯¥å­—æ®µæŒ‡å®šçš„ Unit ä¹Ÿè¦å¯åŠ¨ï¼Œé‚£ä¹ˆå¿…é¡»åœ¨å½“å‰ Unit ä¹‹åå¯åŠ¨</li> <li><code>After</code>ï¼šå¦‚æœè¯¥å­—æ®µæŒ‡å®šçš„ Unit ä¹Ÿè¦å¯åŠ¨ï¼Œé‚£ä¹ˆå¿…é¡»åœ¨å½“å‰ Unit ä¹‹å‰å¯åŠ¨</li> <li><code>Conflicts</code>ï¼šè¿™é‡ŒæŒ‡å®šçš„ Unit ä¸èƒ½ä¸å½“å‰ Unit åŒæ—¶è¿è¡Œ</li> <li><code>Condition...</code>ï¼šå½“å‰ Unit è¿è¡Œå¿…é¡»æ»¡è¶³çš„æ¡ä»¶ï¼Œå¦åˆ™ä¸ä¼šè¿è¡Œ</li> <li><code>Assert...</code>ï¼šå½“å‰ Unit è¿è¡Œå¿…é¡»æ»¡è¶³çš„æ¡ä»¶ï¼Œå¦åˆ™ä¼šæŠ¥å¯åŠ¨å¤±è´¥</li></ul> <p><code>[Install]</code>é€šå¸¸æ˜¯é…ç½®æ–‡ä»¶çš„æœ€åä¸€ä¸ªåŒºå—ï¼Œç”¨æ¥å®šä¹‰å¦‚ä½•å¯åŠ¨ï¼Œä»¥åŠæ˜¯å¦å¼€æœºå¯åŠ¨ã€‚å®ƒ
çš„ä¸»è¦å­—æ®µå¦‚ä¸‹ã€‚</p> <ul><li><code>WantedBy</code>ï¼šå®ƒçš„å€¼æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ª Targetï¼Œå½“å‰ Unit æ¿€æ´»æ—¶ï¼ˆenableï¼‰ç¬¦å·é“¾æ¥ä¼šæ”¾
å…¥<code>/etc/systemd/system</code>ç›®å½•ä¸‹é¢ä»¥ Target å + <code>.wants</code>åç¼€æ„æˆçš„å­ç›®å½•ä¸­</li> <li><code>RequiredBy</code>ï¼šå®ƒçš„å€¼æ˜¯ä¸€ä¸ªæˆ–å¤šä¸ª Targetï¼Œå½“å‰ Unit æ¿€æ´»æ—¶ï¼Œç¬¦å·é“¾æ¥ä¼šæ”¾
å…¥<code>/etc/systemd/system</code>ç›®å½•ä¸‹é¢ä»¥ Target å + <code>.required</code>åç¼€æ„æˆçš„å­ç›®å½•ä¸­</li> <li><code>Alias</code>ï¼šå½“å‰ Unit å¯ç”¨äºå¯åŠ¨çš„åˆ«å</li> <li><code>Also</code>ï¼šå½“å‰ Unit æ¿€æ´»ï¼ˆenableï¼‰æ—¶ï¼Œä¼šè¢«åŒæ—¶æ¿€æ´»çš„å…¶ä»– Unit</li></ul> <p><code>[Service]</code>åŒºå—ç”¨æ¥ Service çš„é…ç½®ï¼Œåªæœ‰ Service ç±»å‹çš„ Unit æ‰æœ‰è¿™ä¸ªåŒºå—ã€‚å®ƒçš„
ä¸»è¦å­—æ®µå¦‚ä¸‹ã€‚</p> <ul><li><code>Type</code>ï¼šå®šä¹‰å¯åŠ¨æ—¶çš„è¿›ç¨‹è¡Œä¸ºã€‚å®ƒæœ‰ä»¥ä¸‹å‡ ç§å€¼ã€‚</li> <li><code>Type=simple</code>ï¼šé»˜è®¤å€¼ï¼Œæ‰§è¡Œ<code>ExecStart</code>æŒ‡å®šçš„å‘½ä»¤ï¼Œå¯åŠ¨ä¸»è¿›ç¨‹</li> <li><code>Type=forking</code>ï¼šä»¥ fork æ–¹å¼ä»çˆ¶è¿›ç¨‹åˆ›å»ºå­è¿›ç¨‹ï¼Œåˆ›å»ºåçˆ¶è¿›ç¨‹ä¼šç«‹å³é€€å‡º</li> <li><code>Type=oneshot</code>ï¼šä¸€æ¬¡æ€§è¿›ç¨‹ï¼ŒSystemd ä¼šç­‰å½“å‰æœåŠ¡é€€å‡ºï¼Œå†ç»§ç»­å¾€ä¸‹æ‰§è¡Œ</li> <li><code>Type=dbus</code>ï¼šå½“å‰æœåŠ¡é€šè¿‡ D-Bus å¯åŠ¨</li> <li><code>Type=notify</code>ï¼šå½“å‰æœåŠ¡å¯åŠ¨å®Œæ¯•ï¼Œä¼šé€šçŸ¥<code>Systemd</code>ï¼Œå†ç»§ç»­å¾€ä¸‹æ‰§è¡Œ</li> <li><code>Type=idle</code>ï¼šè‹¥æœ‰å…¶ä»–ä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œå½“å‰æœåŠ¡æ‰ä¼šè¿è¡Œ</li> <li><code>ExecStart</code>ï¼šå¯åŠ¨å½“å‰æœåŠ¡çš„å‘½ä»¤</li> <li><code>ExecStartPre</code>ï¼šå¯åŠ¨å½“å‰æœåŠ¡ä¹‹å‰æ‰§è¡Œçš„å‘½ä»¤</li> <li><code>ExecStartPost</code>ï¼šå¯åŠ¨å½“å‰æœåŠ¡ä¹‹åæ‰§è¡Œçš„å‘½ä»¤</li> <li><code>ExecReload</code>ï¼šé‡å¯å½“å‰æœåŠ¡æ—¶æ‰§è¡Œçš„å‘½ä»¤</li> <li><code>ExecStop</code>ï¼šåœæ­¢å½“å‰æœåŠ¡æ—¶æ‰§è¡Œçš„å‘½ä»¤</li> <li><code>ExecStopPost</code>ï¼šåœæ­¢å½“å…¶æœåŠ¡ä¹‹åæ‰§è¡Œçš„å‘½ä»¤</li> <li><code>RestartSec</code>ï¼šè‡ªåŠ¨é‡å¯å½“å‰æœåŠ¡é—´éš”çš„ç§’æ•°</li> <li><code>Restart</code>ï¼šå®šä¹‰ä½•ç§æƒ…å†µ Systemd ä¼šè‡ªåŠ¨é‡å¯å½“å‰æœåŠ¡ï¼Œå¯èƒ½çš„å€¼åŒ…æ‹¬<code>always</code>ï¼ˆæ€»æ˜¯
é‡å¯ï¼‰ã€<code>on-success</code>ã€<code>on-failure</code>ã€<code>on-abnormal</code>ã€<code>on-abort</code>ã€<code>on-watchdog</code></li> <li><code>TimeoutSec</code>ï¼šå®šä¹‰ Systemd åœæ­¢å½“å‰æœåŠ¡ä¹‹å‰ç­‰å¾…çš„ç§’æ•°</li> <li><code>Environment</code>ï¼šæŒ‡å®šç¯å¢ƒå˜é‡</li></ul> <p>Unit é…ç½®æ–‡ä»¶çš„å®Œæ•´å­—æ®µæ¸…å•ï¼Œè¯·å‚
è€ƒ<a href="https://www.freedesktop.org/software/systemd/man/systemd.unit.html" target="_blank" rel="noopener noreferrer">å®˜æ–¹æ–‡æ¡£<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã€‚</p> <h2 id="_6-target"><a href="#_6-target" class="header-anchor">#</a> 6. Target</h2> <p>å¯åŠ¨è®¡ç®—æœºçš„æ—¶å€™ï¼Œéœ€è¦å¯åŠ¨å¤§é‡çš„ Unitã€‚å¦‚æœæ¯ä¸€æ¬¡å¯åŠ¨ï¼Œéƒ½è¦ä¸€ä¸€å†™æ˜æœ¬æ¬¡å¯åŠ¨éœ€è¦
å“ªäº› Unitï¼Œæ˜¾ç„¶éå¸¸ä¸æ–¹ä¾¿ã€‚Systemd çš„è§£å†³æ–¹æ¡ˆå°±æ˜¯ Targetã€‚</p> <p>ç®€å•è¯´ï¼ŒTarget å°±æ˜¯ä¸€ä¸ª Unit ç»„ï¼ŒåŒ…å«è®¸å¤šç›¸å…³çš„ Unit ã€‚å¯åŠ¨æŸä¸ª Target çš„æ—¶å€™
ï¼ŒSystemd å°±ä¼šå¯åŠ¨é‡Œé¢æ‰€æœ‰çš„ Unitã€‚ä»è¿™ä¸ªæ„ä¹‰ä¸Šè¯´ï¼ŒTarget è¿™ä¸ªæ¦‚å¿µç±»ä¼¼äº&quot;çŠ¶æ€ç‚¹
&quot;ï¼Œå¯åŠ¨æŸä¸ª Target å°±å¥½æ¯”å¯åŠ¨åˆ°æŸç§çŠ¶æ€ã€‚</p> <p>ä¼ ç»Ÿçš„<code>init</code>å¯åŠ¨æ¨¡å¼é‡Œé¢ï¼Œæœ‰ RunLevel çš„æ¦‚å¿µï¼Œè·Ÿ Target çš„ä½œç”¨å¾ˆç±»ä¼¼ã€‚ä¸åŒçš„æ˜¯
ï¼ŒRunLevel æ˜¯äº’æ–¥çš„ï¼Œä¸å¯èƒ½å¤šä¸ª RunLevel åŒæ—¶å¯åŠ¨ï¼Œä½†æ˜¯å¤šä¸ª Target å¯ä»¥åŒæ—¶å¯åŠ¨
ã€‚</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># æŸ¥çœ‹å½“å‰ç³»ç»Ÿçš„æ‰€æœ‰ Target</span>
$ systemctl list-unit-files --type<span class="token operator">=</span>target

<span class="token comment"># æŸ¥çœ‹ä¸€ä¸ª Target åŒ…å«çš„æ‰€æœ‰ Unit</span>
$ systemctl list-dependencies multi-user.target

<span class="token comment"># æŸ¥çœ‹å¯åŠ¨æ—¶çš„é»˜è®¤ Target</span>
$ systemctl get-default

<span class="token comment"># è®¾ç½®å¯åŠ¨æ—¶çš„é»˜è®¤ Target</span>
$ <span class="token function">sudo</span> systemctl set-default multi-user.target

<span class="token comment"># åˆ‡æ¢ Target æ—¶ï¼Œé»˜è®¤ä¸å…³é—­å‰ä¸€ä¸ª Target å¯åŠ¨çš„è¿›ç¨‹ï¼Œ</span>
<span class="token comment"># systemctl isolate å‘½ä»¤æ”¹å˜è¿™ç§è¡Œä¸ºï¼Œ</span>
<span class="token comment"># å…³é—­å‰ä¸€ä¸ª Target é‡Œé¢æ‰€æœ‰ä¸å±äºåä¸€ä¸ª Target çš„è¿›ç¨‹</span>
$ <span class="token function">sudo</span> systemctl isolate multi-user.target
</code></pre></div><p>Target ä¸ ä¼ ç»Ÿ RunLevel çš„å¯¹åº”å…³ç³»å¦‚ä¸‹ã€‚</p> <div class="language-bash extra-class"><pre class="language-bash"><code>Traditional runlevel      New target name     Symbolically linked to<span class="token punctuation">..</span>.

Runlevel <span class="token number">0</span>           <span class="token operator">|</span>    runlevel0.target -<span class="token operator">&gt;</span> poweroff.target
Runlevel <span class="token number">1</span>           <span class="token operator">|</span>    runlevel1.target -<span class="token operator">&gt;</span> rescue.target
Runlevel <span class="token number">2</span>           <span class="token operator">|</span>    runlevel2.target -<span class="token operator">&gt;</span> multi-user.target
Runlevel <span class="token number">3</span>           <span class="token operator">|</span>    runlevel3.target -<span class="token operator">&gt;</span> multi-user.target
Runlevel <span class="token number">4</span>           <span class="token operator">|</span>    runlevel4.target -<span class="token operator">&gt;</span> multi-user.target
Runlevel <span class="token number">5</span>           <span class="token operator">|</span>    runlevel5.target -<span class="token operator">&gt;</span> graphical.target
Runlevel <span class="token number">6</span>           <span class="token operator">|</span>    runlevel6.target -<span class="token operator">&gt;</span> reboot.target
</code></pre></div><p>å®ƒä¸<code>init</code>è¿›ç¨‹çš„ä¸»è¦å·®åˆ«å¦‚ä¸‹ã€‚</p> <p><strong>ï¼ˆ1ï¼‰é»˜è®¤çš„ RunLevel</strong>ï¼ˆåœ¨<code>/etc/inittab</code>æ–‡ä»¶è®¾ç½®ï¼‰ç°åœ¨è¢«é»˜è®¤çš„ Target å–ä»£ï¼Œ
ä½ç½®æ˜¯<code>/etc/systemd/system/default.target</code>ï¼Œé€šå¸¸ç¬¦å·é“¾æ¥åˆ°<code>graphical.target</code>ï¼ˆ
å›¾å½¢ç•Œé¢ï¼‰æˆ–è€…<code>multi-user.target</code>ï¼ˆå¤šç”¨æˆ·å‘½ä»¤è¡Œï¼‰ã€‚</p> <p><strong>ï¼ˆ2ï¼‰å¯åŠ¨è„šæœ¬çš„ä½ç½®</strong>ï¼Œä»¥å‰æ˜¯<code>/etc/init.d</code>ç›®å½•ï¼Œç¬¦å·é“¾æ¥åˆ°ä¸åŒçš„ RunLevel ç›®
å½• ï¼ˆæ¯”å¦‚<code>/etc/rc3.d</code>ã€<code>/etc/rc5.d</code>ç­‰ï¼‰ï¼Œç°åœ¨åˆ™å­˜æ”¾
åœ¨<code>/lib/systemd/system</code>å’Œ<code>/etc/systemd/system</code>ç›®å½•ã€‚</p> <p><strong>ï¼ˆ3ï¼‰é…ç½®æ–‡ä»¶çš„ä½ç½®</strong>ï¼Œä»¥å‰<code>init</code>è¿›ç¨‹çš„é…ç½®æ–‡ä»¶æ˜¯<code>/etc/inittab</code>ï¼Œå„ç§æœåŠ¡çš„
é…ç½®æ–‡ä»¶å­˜æ”¾åœ¨<code>/etc/sysconfig</code>ç›®å½•ã€‚ç°åœ¨çš„é…ç½®æ–‡ä»¶ä¸»è¦å­˜æ”¾åœ¨<code>/lib/systemd</code>ç›®å½•
ï¼Œåœ¨<code>/etc/systemd</code>ç›®å½•é‡Œé¢çš„ä¿®æ”¹å¯ä»¥è¦†ç›–åŸå§‹è®¾ç½®ã€‚</p> <h2 id="_7-æ—¥å¿—ç®¡ç†"><a href="#_7-æ—¥å¿—ç®¡ç†" class="header-anchor">#</a> 7. æ—¥å¿—ç®¡ç†</h2> <p>Systemd ç»Ÿä¸€ç®¡ç†æ‰€æœ‰ Unit çš„å¯åŠ¨æ—¥å¿—ã€‚å¸¦æ¥çš„å¥½å¤„å°±æ˜¯ï¼Œå¯ä»¥åªç”¨<code>journalctl</code>ä¸€ä¸ªå‘½
ä»¤ï¼ŒæŸ¥çœ‹æ‰€æœ‰æ—¥å¿—ï¼ˆå†…æ ¸æ—¥å¿—å’Œåº”ç”¨æ—¥å¿—ï¼‰ã€‚æ—¥å¿—çš„é…ç½®æ–‡ä»¶
æ˜¯<code>/etc/systemd/journald.conf</code>ã€‚</p> <p><code>journalctl</code>åŠŸèƒ½å¼ºå¤§ï¼Œç”¨æ³•éå¸¸å¤šã€‚</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># æŸ¥çœ‹æ‰€æœ‰æ—¥å¿—ï¼ˆé»˜è®¤æƒ…å†µä¸‹ ï¼Œåªä¿å­˜æœ¬æ¬¡å¯åŠ¨çš„æ—¥å¿—ï¼‰</span>
$ <span class="token function">sudo</span> journalctl

<span class="token comment"># æŸ¥çœ‹å†…æ ¸æ—¥å¿—ï¼ˆä¸æ˜¾ç¤ºåº”ç”¨æ—¥å¿—ï¼‰</span>
$ <span class="token function">sudo</span> journalctl -k

<span class="token comment"># æŸ¥çœ‹ç³»ç»Ÿæœ¬æ¬¡å¯åŠ¨çš„æ—¥å¿—</span>
$ <span class="token function">sudo</span> journalctl -b
$ <span class="token function">sudo</span> journalctl -b -0

<span class="token comment"># æŸ¥çœ‹ä¸Šä¸€æ¬¡å¯åŠ¨çš„æ—¥å¿—ï¼ˆéœ€æ›´æ”¹è®¾ç½®ï¼‰</span>
$ <span class="token function">sudo</span> journalctl -b -1

<span class="token comment"># æŸ¥çœ‹æŒ‡å®šæ—¶é—´çš„æ—¥å¿—</span>
$ <span class="token function">sudo</span> journalctl --since<span class="token operator">=</span><span class="token string">&quot;2012-10-30 18:17:16&quot;</span>
$ <span class="token function">sudo</span> journalctl --since <span class="token string">&quot;20 min ago&quot;</span>
$ <span class="token function">sudo</span> journalctl --since yesterday
$ <span class="token function">sudo</span> journalctl --since <span class="token string">&quot;2015-01-10&quot;</span> --until <span class="token string">&quot;2015-01-11 03:00&quot;</span>
$ <span class="token function">sudo</span> journalctl --since 09:00 --until <span class="token string">&quot;1 hour ago&quot;</span>

<span class="token comment"># æ˜¾ç¤ºå°¾éƒ¨çš„æœ€æ–°10è¡Œæ—¥å¿—</span>
$ <span class="token function">sudo</span> journalctl -n

<span class="token comment"># æ˜¾ç¤ºå°¾éƒ¨æŒ‡å®šè¡Œæ•°çš„æ—¥å¿—</span>
$ <span class="token function">sudo</span> journalctl -n <span class="token number">20</span>

<span class="token comment"># å®æ—¶æ»šåŠ¨æ˜¾ç¤ºæœ€æ–°æ—¥å¿—</span>
$ <span class="token function">sudo</span> journalctl -f

<span class="token comment"># æŸ¥çœ‹æŒ‡å®šæœåŠ¡çš„æ—¥å¿—</span>
$ <span class="token function">sudo</span> journalctl /usr/lib/systemd/systemd

<span class="token comment"># æŸ¥çœ‹æŒ‡å®šè¿›ç¨‹çš„æ—¥å¿—</span>
$ <span class="token function">sudo</span> journalctl <span class="token assign-left variable">_PID</span><span class="token operator">=</span><span class="token number">1</span>

<span class="token comment"># æŸ¥çœ‹æŸä¸ªè·¯å¾„çš„è„šæœ¬çš„æ—¥å¿—</span>
$ <span class="token function">sudo</span> journalctl /usr/bin/bash

<span class="token comment"># æŸ¥çœ‹æŒ‡å®šç”¨æˆ·çš„æ—¥å¿—</span>
$ <span class="token function">sudo</span> journalctl <span class="token assign-left variable">_UID</span><span class="token operator">=</span><span class="token number">33</span> --since today

<span class="token comment"># æŸ¥çœ‹æŸä¸ª Unit çš„æ—¥å¿—</span>
$ <span class="token function">sudo</span> journalctl -u nginx.service
$ <span class="token function">sudo</span> journalctl -u nginx.service --since today

<span class="token comment"># å®æ—¶æ»šåŠ¨æ˜¾ç¤ºæŸä¸ª Unit çš„æœ€æ–°æ—¥å¿—</span>
$ <span class="token function">sudo</span> journalctl -u nginx.service -f

<span class="token comment"># åˆå¹¶æ˜¾ç¤ºå¤šä¸ª Unit çš„æ—¥å¿—</span>
$ journalctl -u nginx.service -u php-fpm.service --since today

<span class="token comment"># æŸ¥çœ‹æŒ‡å®šä¼˜å…ˆçº§ï¼ˆåŠå…¶ä»¥ä¸Šçº§åˆ«ï¼‰çš„æ—¥å¿—ï¼Œå…±æœ‰8çº§</span>
<span class="token comment"># 0: emerg</span>
<span class="token comment"># 1: alert</span>
<span class="token comment"># 2: crit</span>
<span class="token comment"># 3: err</span>
<span class="token comment"># 4: warning</span>
<span class="token comment"># 5: notice</span>
<span class="token comment"># 6: info</span>
<span class="token comment"># 7: debug</span>
$ <span class="token function">sudo</span> journalctl -p err -b

<span class="token comment"># æ—¥å¿—é»˜è®¤åˆ†é¡µè¾“å‡ºï¼Œ--no-pager æ”¹ä¸ºæ­£å¸¸çš„æ ‡å‡†è¾“å‡º</span>
$ <span class="token function">sudo</span> journalctl --no-pager

<span class="token comment"># ä»¥ JSON æ ¼å¼ï¼ˆå•è¡Œï¼‰è¾“å‡º</span>
$ <span class="token function">sudo</span> journalctl -b -u nginx.service -o json

<span class="token comment"># ä»¥ JSON æ ¼å¼ï¼ˆå¤šè¡Œï¼‰è¾“å‡ºï¼Œå¯è¯»æ€§æ›´å¥½</span>
$ <span class="token function">sudo</span> journalctl -b -u nginx.serviceqq
 -o json-pretty

<span class="token comment"># æ˜¾ç¤ºæ—¥å¿—å æ®çš„ç¡¬ç›˜ç©ºé—´</span>
$ <span class="token function">sudo</span> journalctl --disk-usage

<span class="token comment"># æŒ‡å®šæ—¥å¿—æ–‡ä»¶å æ®çš„æœ€å¤§ç©ºé—´</span>
$ <span class="token function">sudo</span> journalctl --vacuum-size<span class="token operator">=</span>1G

<span class="token comment"># æŒ‡å®šæ—¥å¿—æ–‡ä»¶ä¿å­˜å¤šä¹…</span>
$ <span class="token function">sudo</span> journalctl --vacuum-time<span class="token operator">=</span>1years
</code></pre></div><h2 id="_8-å®æˆ˜"><a href="#_8-å®æˆ˜" class="header-anchor">#</a> 8. å®æˆ˜</h2> <h3 id="_8-1-å¼€æœºå¯åŠ¨"><a href="#_8-1-å¼€æœºå¯åŠ¨" class="header-anchor">#</a> 8.1. å¼€æœºå¯åŠ¨</h3> <p>å¯¹äºé‚£äº›æ”¯æŒ Systemd çš„è½¯ä»¶ï¼Œå®‰è£…çš„æ—¶å€™ï¼Œä¼šè‡ªåŠ¨åœ¨<code>/usr/lib/systemd/system</code>ç›®å½•æ·»
åŠ ä¸€ä¸ªé…ç½®æ–‡ä»¶ã€‚</p> <p>å¦‚æœä½ æƒ³è®©è¯¥è½¯ä»¶å¼€æœºå¯åŠ¨ï¼Œå°±æ‰§è¡Œä¸‹é¢çš„å‘½ä»¤ï¼ˆä»¥<code>httpd.service</code>ä¸ºä¾‹ï¼‰ã€‚</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">sudo</span> systemctl <span class="token builtin class-name">enable</span> httpd
</code></pre></div><p>ä¸Šé¢çš„å‘½ä»¤ç›¸å½“äºåœ¨<code>/etc/systemd/system</code>ç›®å½•æ·»åŠ ä¸€ä¸ªç¬¦å·é“¾æ¥ï¼ŒæŒ‡
å‘<code>/usr/lib/systemd/system</code>é‡Œé¢çš„<code>httpd.service</code>æ–‡ä»¶ã€‚</p> <p>è¿™æ˜¯å› ä¸ºå¼€æœºæ—¶ï¼Œ<code>Systemd</code>åªæ‰§è¡Œ<code>/etc/systemd/system</code>ç›®å½•é‡Œé¢çš„é…ç½®æ–‡ä»¶ã€‚è¿™ä¹Ÿæ„å‘³
ç€ï¼Œå¦‚æœæŠŠä¿®æ”¹åçš„é…ç½®æ–‡ä»¶æ”¾åœ¨è¯¥ç›®å½•ï¼Œå°±å¯ä»¥è¾¾åˆ°è¦†ç›–åŸå§‹é…ç½®çš„æ•ˆæœã€‚</p> <h3 id="_8-2-å¯åŠ¨æœåŠ¡"><a href="#_8-2-å¯åŠ¨æœåŠ¡" class="header-anchor">#</a> 8.2. å¯åŠ¨æœåŠ¡</h3> <p>è®¾ç½®å¼€æœºå¯åŠ¨ä»¥åï¼Œè½¯ä»¶å¹¶ä¸ä¼šç«‹å³å¯åŠ¨ï¼Œå¿…é¡»ç­‰åˆ°ä¸‹ä¸€æ¬¡å¼€æœºã€‚å¦‚æœæƒ³ç°åœ¨å°±è¿è¡Œè¯¥è½¯ä»¶
ï¼Œé‚£ä¹ˆè¦æ‰§è¡Œ<code>systemctl start</code>å‘½ä»¤ã€‚</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">sudo</span> systemctl start httpd
</code></pre></div><p>æ‰§è¡Œä¸Šé¢çš„å‘½ä»¤ä»¥åï¼Œæœ‰å¯èƒ½å¯åŠ¨å¤±è´¥ï¼Œå› æ­¤è¦ç”¨<code>systemctl status</code>å‘½ä»¤æŸ¥çœ‹ä¸€ä¸‹è¯¥æœåŠ¡
çš„çŠ¶æ€ã€‚</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">sudo</span> systemctl status httpd

httpd.service - The Apache HTTP Server
Loaded: loaded <span class="token punctuation">(</span>/usr/lib/systemd/system/httpd.service<span class="token punctuation">;</span> enabled<span class="token punctuation">)</span>
Active: active <span class="token punctuation">(</span>running<span class="token punctuation">)</span> since é‡‘ <span class="token number">2014</span>-12-05 <span class="token number">12</span>:18:22 JST<span class="token punctuation">;</span> 7min ago
Main PID: <span class="token number">4349</span> <span class="token punctuation">(</span>httpd<span class="token punctuation">)</span>
Status: <span class="token string">&quot;Total requests: 1; Current requests/sec: 0; Current traffic:   0 B/sec&quot;</span>
CGroup: /system.slice/httpd.service
        â”œâ”€4349 /usr/sbin/httpd -DFOREGROUND
        â”œâ”€4350 /usr/sbin/httpd -DFOREGROUND
        â”œâ”€4351 /usr/sbin/httpd -DFOREGROUND
        â”œâ”€4352 /usr/sbin/httpd -DFOREGROUND
        â”œâ”€4353 /usr/sbin/httpd -DFOREGROUND
        â””â”€4354 /usr/sbin/httpd -DFOREGROUND

<span class="token number">12</span>æœˆ 05 <span class="token number">12</span>:18:22 localhost.localdomain systemd<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>: Starting The Apache HTTP Server<span class="token punctuation">..</span>.
<span class="token number">12</span>æœˆ 05 <span class="token number">12</span>:18:22 localhost.localdomain systemd<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>: Started The Apache HTTP Server.
<span class="token number">12</span>æœˆ 05 <span class="token number">12</span>:22:40 localhost.localdomain systemd<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>: Started The Apache HTTP Server.
</code></pre></div><p>ä¸Šé¢çš„è¾“å‡ºç»“æœå«ä¹‰å¦‚ä¸‹ã€‚</p> <ul><li><code>Loaded</code>è¡Œï¼šé…ç½®æ–‡ä»¶çš„ä½ç½®ï¼Œæ˜¯å¦è®¾ä¸ºå¼€æœºå¯åŠ¨</li> <li><code>Active</code>è¡Œï¼šè¡¨ç¤ºæ­£åœ¨è¿è¡Œ</li> <li><code>Main PID</code>è¡Œï¼šä¸»è¿›ç¨‹ ID</li> <li><code>Status</code>è¡Œï¼šç”±åº”ç”¨æœ¬èº«ï¼ˆè¿™é‡Œæ˜¯ httpd ï¼‰æä¾›çš„è½¯ä»¶å½“å‰çŠ¶æ€</li> <li><code>CGroup</code>å—ï¼šåº”ç”¨çš„æ‰€æœ‰å­è¿›ç¨‹</li> <li>æ—¥å¿—å—ï¼šåº”ç”¨çš„æ—¥å¿—</li></ul> <h3 id="_8-3-åœæ­¢æœåŠ¡"><a href="#_8-3-åœæ­¢æœåŠ¡" class="header-anchor">#</a> 8.3. åœæ­¢æœåŠ¡</h3> <p>ç»ˆæ­¢æ­£åœ¨è¿è¡Œçš„æœåŠ¡ï¼Œéœ€è¦æ‰§è¡Œ<code>systemctl stop</code>å‘½ä»¤ã€‚</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">sudo</span> systemctl stop httpd.service
</code></pre></div><p>æœ‰æ—¶å€™ï¼Œè¯¥å‘½ä»¤å¯èƒ½æ²¡æœ‰å“åº”ï¼ŒæœåŠ¡åœä¸ä¸‹æ¥ã€‚è¿™æ—¶å€™å°±ä¸å¾—ä¸&quot;æ€è¿›ç¨‹&quot;äº†ï¼Œå‘æ­£åœ¨è¿è¡Œçš„
è¿›ç¨‹å‘å‡º<code>kill</code>ä¿¡å·ã€‚</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">sudo</span> systemctl <span class="token function">kill</span> httpd.service
</code></pre></div><p>æ­¤å¤–ï¼Œé‡å¯æœåŠ¡è¦æ‰§è¡Œ<code>systemctl restart</code>å‘½ä»¤ã€‚</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ <span class="token function">sudo</span> systemctl restart httpd.service
</code></pre></div><h3 id="_8-4-è¯»æ‡‚é…ç½®æ–‡ä»¶"><a href="#_8-4-è¯»æ‡‚é…ç½®æ–‡ä»¶" class="header-anchor">#</a> 8.4. è¯»æ‡‚é…ç½®æ–‡ä»¶</h3> <p>ä¸€ä¸ªæœåŠ¡æ€ä¹ˆå¯åŠ¨ï¼Œå®Œå…¨ç”±å®ƒçš„é…ç½®æ–‡ä»¶å†³å®šã€‚ä¸‹é¢å°±æ¥çœ‹ï¼Œé…ç½®æ–‡ä»¶æœ‰äº›ä»€ä¹ˆå†…å®¹ã€‚</p> <p>å‰é¢è¯´è¿‡ï¼Œé…ç½®æ–‡ä»¶ä¸»è¦æ”¾åœ¨<code>/usr/lib/systemd/system</code>ç›®å½•ï¼Œä¹Ÿå¯èƒ½
åœ¨<code>/etc/systemd/system</code>ç›®å½•ã€‚æ‰¾åˆ°é…ç½®æ–‡ä»¶ä»¥åï¼Œä½¿ç”¨æ–‡æœ¬ç¼–è¾‘å™¨æ‰“å¼€å³å¯ã€‚</p> <p><code>systemctl cat</code>å‘½ä»¤å¯ä»¥ç”¨æ¥æŸ¥çœ‹é…ç½®æ–‡ä»¶ï¼Œä¸‹é¢ä»¥<code>sshd.service</code>æ–‡ä»¶ä¸ºä¾‹ï¼Œå®ƒçš„ä½œç”¨
æ˜¯å¯åŠ¨ä¸€ä¸ª SSH æœåŠ¡å™¨ï¼Œä¾›å…¶ä»–ç”¨æˆ·ä»¥ SSH æ–¹å¼ç™»å½•ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>$ systemctl cat sshd.service

[Unit]
Description=OpenSSH server daemon
Documentation=man:sshd(8) man:sshd_config(5)
After=network.target sshd-keygen.service
Wants=sshd-keygen.service

[Service]
EnvironmentFile=/etc/sysconfig/sshd
ExecStart=/usr/sbin/sshd -D $OPTIONS
ExecReload=/bin/kill -HUP $MAINPID
Type=simple
KillMode=process
Restart=on-failure
RestartSec=42s

[Install]
WantedBy=multi-user.target
</code></pre></div><p>å¯ä»¥çœ‹åˆ°ï¼Œé…ç½®æ–‡ä»¶åˆ†æˆå‡ ä¸ªåŒºå—ï¼Œæ¯ä¸ªåŒºå—åŒ…å«è‹¥å¹²æ¡é”®å€¼å¯¹ã€‚</p> <p>ä¸‹é¢ä¾æ¬¡è§£é‡Šæ¯ä¸ªåŒºå—çš„å†…å®¹ã€‚</p> <h3 id="_8-5-unit-åŒºå—-å¯åŠ¨é¡ºåºä¸ä¾èµ–å…³ç³»ã€‚"><a href="#_8-5-unit-åŒºå—-å¯åŠ¨é¡ºåºä¸ä¾èµ–å…³ç³»ã€‚" class="header-anchor">#</a> 8.5. [Unit] åŒºå—ï¼šå¯åŠ¨é¡ºåºä¸ä¾èµ–å…³ç³»ã€‚</h3> <p><code>Unit</code>åŒºå—çš„<code>Description</code>å­—æ®µç»™å‡ºå½“å‰æœåŠ¡çš„ç®€å•æè¿°ï¼Œ<code>Documentation</code>å­—æ®µç»™å‡ºæ–‡æ¡£
ä½ç½®ã€‚</p> <p>æ¥ä¸‹æ¥çš„è®¾ç½®æ˜¯å¯åŠ¨é¡ºåºå’Œä¾èµ–å…³ç³»ï¼Œè¿™ä¸ªæ¯”è¾ƒé‡è¦ã€‚</p> <blockquote><p><code>After</code>å­—æ®µï¼šè¡¨ç¤ºå¦‚æœ<code>network.target</code>æˆ–<code>sshd-keygen.service</code>éœ€è¦å¯åŠ¨ï¼Œé‚£
ä¹ˆ<code>sshd.service</code>åº”è¯¥åœ¨å®ƒä»¬ä¹‹åå¯åŠ¨ã€‚</p></blockquote> <p>ç›¸åº”åœ°ï¼Œè¿˜æœ‰ä¸€ä¸ª<code>Before</code>å­—æ®µï¼Œå®šä¹‰<code>sshd.service</code>åº”è¯¥åœ¨å“ªäº›æœåŠ¡ä¹‹å‰å¯åŠ¨ã€‚</p> <p>æ³¨æ„ï¼Œ<code>After</code>å’Œ<code>Before</code>å­—æ®µåªæ¶‰åŠå¯åŠ¨é¡ºåºï¼Œä¸æ¶‰åŠä¾èµ–å…³ç³»ã€‚</p> <p>ä¸¾ä¾‹æ¥è¯´ï¼ŒæŸ Web åº”ç”¨éœ€è¦ postgresql æ•°æ®åº“å‚¨å­˜æ•°æ®ã€‚åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œå®ƒåªå®šä¹‰è¦åœ¨
postgresql ä¹‹åå¯åŠ¨ï¼Œè€Œæ²¡æœ‰å®šä¹‰ä¾èµ– postgresql ã€‚ä¸Šçº¿åï¼Œç”±äºæŸç§åŸå› 
ï¼Œpostgresql éœ€è¦é‡æ–°å¯åŠ¨ï¼Œåœ¨åœæ­¢æœåŠ¡æœŸé—´ï¼Œè¯¥ Web åº”ç”¨å°±ä¼šæ— æ³•å»ºç«‹æ•°æ®åº“è¿æ¥ã€‚</p> <p>è®¾ç½®ä¾èµ–å…³ç³»ï¼Œéœ€è¦ä½¿ç”¨<code>Wants</code>å­—æ®µå’Œ<code>Requires</code>å­—æ®µã€‚</p> <blockquote><p><code>Wants</code>å­—æ®µï¼šè¡¨ç¤º<code>sshd.service</code>ä¸<code>sshd-keygen.service</code>ä¹‹é—´å­˜åœ¨&quot;å¼±ä¾èµ–&quot;å…³ç³»ï¼Œå³
å¦‚æœ&quot;sshd-keygen.service&quot;å¯åŠ¨å¤±è´¥æˆ–åœæ­¢è¿è¡Œï¼Œä¸å½±å“<code>sshd.service</code>ç»§ç»­æ‰§è¡Œã€‚</p></blockquote> <p><code>Requires</code>å­—æ®µåˆ™è¡¨ç¤º&quot;å¼ºä¾èµ–&quot;å…³ç³»ï¼Œå³å¦‚æœè¯¥æœåŠ¡å¯åŠ¨å¤±è´¥æˆ–å¼‚å¸¸é€€å‡ºï¼Œé‚£
ä¹ˆ<code>sshd.service</code>ä¹Ÿå¿…é¡»é€€å‡ºã€‚</p> <p>æ³¨æ„ï¼Œ<code>Wants</code>å­—æ®µä¸<code>Requires</code>å­—æ®µåªæ¶‰åŠä¾èµ–å…³ç³»ï¼Œä¸å¯åŠ¨é¡ºåºæ— å…³ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯åŒ
æ—¶å¯åŠ¨çš„ã€‚</p> <h3 id="_8-6-service-åŒºå—-å¯åŠ¨è¡Œä¸º"><a href="#_8-6-service-åŒºå—-å¯åŠ¨è¡Œä¸º" class="header-anchor">#</a> 8.6. [Service] åŒºå—ï¼šå¯åŠ¨è¡Œä¸º</h3> <p><code>Service</code>åŒºå—å®šä¹‰å¦‚ä½•å¯åŠ¨å½“å‰æœåŠ¡ã€‚</p> <h4 id="_8-6-1-å¯åŠ¨å‘½ä»¤"><a href="#_8-6-1-å¯åŠ¨å‘½ä»¤" class="header-anchor">#</a> 8.6.1. å¯åŠ¨å‘½ä»¤</h4> <p>è®¸å¤šè½¯ä»¶éƒ½æœ‰è‡ªå·±çš„ç¯å¢ƒå‚æ•°æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å¯ä»¥ç”¨<code>EnvironmentFile</code>å­—æ®µè¯»å–ã€‚</p> <blockquote><p><code>EnvironmentFile</code>å­—æ®µï¼šæŒ‡å®šå½“å‰æœåŠ¡çš„ç¯å¢ƒå‚æ•°æ–‡ä»¶ã€‚è¯¥æ–‡ä»¶å†…éƒ¨çš„<code>key=value</code>é”®å€¼
å¯¹ï¼Œå¯ä»¥ç”¨<code>$key</code>çš„å½¢å¼ï¼Œåœ¨å½“å‰é…ç½®æ–‡ä»¶ä¸­è·å–ã€‚</p></blockquote> <p>ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œsshd çš„ç¯å¢ƒå‚æ•°æ–‡ä»¶æ˜¯<code>/etc/sysconfig/sshd</code>ã€‚</p> <p>é…ç½®æ–‡ä»¶é‡Œé¢æœ€é‡è¦çš„å­—æ®µæ˜¯<code>ExecStart</code>ã€‚</p> <blockquote><p><code>ExecStart</code>å­—æ®µï¼šå®šä¹‰å¯åŠ¨è¿›ç¨‹æ—¶æ‰§è¡Œçš„å‘½ä»¤ã€‚</p></blockquote> <p>ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œå¯åŠ¨<code>sshd</code>ï¼Œæ‰§è¡Œçš„å‘½ä»¤æ˜¯<code>/usr/sbin/sshd -D $OPTIONS</code>ï¼Œå…¶ä¸­çš„å˜
é‡<code>$OPTIONS</code>å°±æ¥è‡ª<code>EnvironmentFile</code>å­—æ®µæŒ‡å®šçš„ç¯å¢ƒå‚æ•°æ–‡ä»¶ã€‚</p> <p>ä¸ä¹‹ä½œç”¨ç›¸ä¼¼çš„ï¼Œè¿˜æœ‰å¦‚ä¸‹è¿™äº›å­—æ®µã€‚</p> <ul><li><code>ExecReload</code>å­—æ®µï¼šé‡å¯æœåŠ¡æ—¶æ‰§è¡Œçš„å‘½ä»¤</li> <li><code>ExecStop</code>å­—æ®µï¼šåœæ­¢æœåŠ¡æ—¶æ‰§è¡Œçš„å‘½ä»¤</li> <li><code>ExecStartPre</code>å­—æ®µï¼šå¯åŠ¨æœåŠ¡ä¹‹å‰æ‰§è¡Œçš„å‘½ä»¤</li> <li><code>ExecStartPost</code>å­—æ®µï¼šå¯åŠ¨æœåŠ¡ä¹‹åæ‰§è¡Œçš„å‘½ä»¤</li> <li><code>ExecStopPost</code>å­—æ®µï¼šåœæ­¢æœåŠ¡ä¹‹åæ‰§è¡Œçš„å‘½ä»¤</li></ul> <p>è¯·çœ‹ä¸‹é¢çš„ä¾‹å­ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>[Service]
ExecStart=/bin/echo execstart1
ExecStart=
ExecStart=/bin/echo execstart2
ExecStartPost=/bin/echo post1
ExecStartPost=/bin/echo post2
</code></pre></div><p>ä¸Šé¢è¿™ä¸ªé…ç½®æ–‡ä»¶ï¼Œç¬¬äºŒè¡Œ<code>ExecStart</code>è®¾ä¸ºç©ºå€¼ï¼Œç­‰äºå–æ¶ˆäº†ç¬¬ä¸€è¡Œçš„è®¾ç½®ï¼Œè¿è¡Œç»“æœå¦‚
ä¸‹ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>execstart2
post1
post2
</code></pre></div><p>æ‰€æœ‰çš„å¯åŠ¨è®¾ç½®ä¹‹å‰ï¼Œéƒ½å¯ä»¥åŠ ä¸Šä¸€ä¸ªè¿è¯å·ï¼ˆ<code>-</code>ï¼‰ï¼Œè¡¨ç¤º&quot;æŠ‘åˆ¶é”™è¯¯&quot;ï¼Œå³å‘ç”Ÿé”™è¯¯çš„æ—¶
å€™ï¼Œä¸å½±å“å…¶ä»–å‘½ä»¤çš„æ‰§è¡Œã€‚æ¯”å¦‚ï¼Œ<code>EnvironmentFile=-/etc/sysconfig/sshd</code>ï¼ˆæ³¨æ„ç­‰å·
åé¢çš„é‚£ä¸ªè¿è¯å·ï¼‰ï¼Œå°±è¡¨ç¤ºå³ä½¿<code>/etc/sysconfig/sshd</code>æ–‡ä»¶ä¸å­˜åœ¨ï¼Œä¹Ÿä¸ä¼šæŠ›å‡ºé”™è¯¯ã€‚</p> <h4 id="_8-6-2-å¯åŠ¨ç±»å‹"><a href="#_8-6-2-å¯åŠ¨ç±»å‹" class="header-anchor">#</a> 8.6.2. å¯åŠ¨ç±»å‹</h4> <p><code>Type</code>å­—æ®µå®šä¹‰å¯åŠ¨ç±»å‹ã€‚å®ƒå¯ä»¥è®¾ç½®çš„å€¼å¦‚ä¸‹ã€‚</p> <ul><li>simpleï¼ˆé»˜è®¤å€¼ï¼‰ï¼š<code>ExecStart</code>å­—æ®µå¯åŠ¨çš„è¿›ç¨‹ä¸ºä¸»è¿›ç¨‹</li> <li>forkingï¼š<code>ExecStart</code>å­—æ®µå°†ä»¥<code>fork()</code>æ–¹å¼å¯åŠ¨ï¼Œæ­¤æ—¶çˆ¶è¿›ç¨‹å°†ä¼šé€€å‡ºï¼Œå­è¿›ç¨‹å°†æˆ
ä¸ºä¸»è¿›ç¨‹</li> <li>oneshotï¼šç±»ä¼¼äº<code>simple</code>ï¼Œä½†åªæ‰§è¡Œä¸€æ¬¡ï¼ŒSystemd ä¼šç­‰å®ƒæ‰§è¡Œå®Œï¼Œæ‰å¯åŠ¨å…¶ä»–æœåŠ¡</li> <li>dbusï¼šç±»ä¼¼äº<code>simple</code>ï¼Œä½†ä¼šç­‰å¾… D-Bus ä¿¡å·åå¯åŠ¨</li> <li>notifyï¼šç±»ä¼¼äº<code>simple</code>ï¼Œå¯åŠ¨ç»“æŸåä¼šå‘å‡ºé€šçŸ¥ä¿¡å·ï¼Œç„¶å Systemd å†å¯åŠ¨å…¶ä»–æœ
åŠ¡</li> <li>idleï¼šç±»ä¼¼äº<code>simple</code>ï¼Œä½†æ˜¯è¦ç­‰åˆ°å…¶ä»–ä»»åŠ¡éƒ½æ‰§è¡Œå®Œï¼Œæ‰ä¼šå¯åŠ¨è¯¥æœåŠ¡ã€‚ä¸€ç§ä½¿ç”¨åœº
åˆæ˜¯ä¸ºè®©è¯¥æœåŠ¡çš„è¾“å‡ºï¼Œä¸ä¸å…¶ä»–æœåŠ¡çš„è¾“å‡ºç›¸æ··åˆ</li></ul> <p>ä¸‹é¢æ˜¯ä¸€ä¸ª<code>oneshot</code>çš„ä¾‹å­ï¼Œç¬”è®°æœ¬ç”µè„‘å¯åŠ¨æ—¶ï¼Œè¦æŠŠè§¦æ‘¸æ¿å…³æ‰ï¼Œé…ç½®æ–‡ä»¶å¯ä»¥è¿™æ ·å†™
ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>[Unit]
Description=Switch-off Touchpad

[Service]
Type=oneshot
ExecStart=/usr/bin/touchpad-off

[Install]
WantedBy=multi-user.target
</code></pre></div><p>ä¸Šé¢çš„é…ç½®æ–‡ä»¶ï¼Œå¯åŠ¨ç±»å‹è®¾ä¸º<code>oneshot</code>ï¼Œå°±è¡¨æ˜è¿™ä¸ªæœåŠ¡åªè¦è¿è¡Œä¸€æ¬¡å°±å¤Ÿäº†ï¼Œä¸éœ€è¦
é•¿æœŸè¿è¡Œã€‚</p> <p>å¦‚æœå…³é—­ä»¥åï¼Œå°†æ¥æŸä¸ªæ—¶å€™è¿˜æƒ³æ‰“å¼€ï¼Œé…ç½®æ–‡ä»¶ä¿®æ”¹å¦‚ä¸‹ã€‚</p> <div class="language- extra-class"><pre class="language-text"><code>[Unit]
Description=Switch-off Touchpad

[Service]
Type=oneshot
ExecStart=/usr/bin/touchpad-off start
ExecStop=/usr/bin/touchpad-off stop
RemainAfterExit=yes

[Install]
WantedBy=multi-user.target
</code></pre></div><p>ä¸Šé¢é…ç½®æ–‡ä»¶ä¸­ï¼Œ<code>RemainAfterExit</code>å­—æ®µè®¾ä¸º<code>yes</code>ï¼Œè¡¨ç¤ºè¿›ç¨‹é€€å‡ºä»¥åï¼ŒæœåŠ¡ä»ç„¶ä¿æŒæ‰§
è¡Œã€‚è¿™æ ·çš„è¯ï¼Œä¸€æ—¦ä½¿ç”¨<code>systemctl stop</code>å‘½ä»¤åœæ­¢æœåŠ¡ï¼Œ<code>ExecStop</code>æŒ‡å®šçš„å‘½ä»¤å°±ä¼šæ‰§è¡Œ
ï¼Œä»è€Œé‡æ–°å¼€å¯è§¦æ‘¸æ¿ã€‚</p> <h4 id="_8-6-3-é‡å¯è¡Œä¸º"><a href="#_8-6-3-é‡å¯è¡Œä¸º" class="header-anchor">#</a> 8.6.3. é‡å¯è¡Œä¸º</h4> <p><code>Service</code>åŒºå—æœ‰ä¸€äº›å­—æ®µï¼Œå®šä¹‰äº†é‡å¯è¡Œä¸ºã€‚</p> <blockquote><p><code>KillMode</code>å­—æ®µï¼šå®šä¹‰ Systemd å¦‚ä½•åœæ­¢ sshd æœåŠ¡ã€‚</p></blockquote> <p>ä¸Šé¢è¿™ä¸ªä¾‹å­ä¸­ï¼Œå°†<code>KillMode</code>è®¾ä¸º<code>process</code>ï¼Œè¡¨ç¤ºåªåœæ­¢ä¸»è¿›ç¨‹ï¼Œä¸åœæ­¢ä»»ä½• sshd å­
è¿›ç¨‹ï¼Œå³å­è¿›ç¨‹æ‰“å¼€çš„ SSH session ä»ç„¶ä¿æŒè¿æ¥ã€‚è¿™ä¸ªè®¾ç½®ä¸å¤ªå¸¸è§ï¼Œä½†å¯¹ sshd å¾ˆé‡
è¦ï¼Œå¦åˆ™ä½ åœæ­¢æœåŠ¡çš„æ—¶å€™ï¼Œä¼šè¿è‡ªå·±æ‰“å¼€çš„ SSH session ä¸€èµ·æ€æ‰ã€‚</p> <p><code>KillMode</code>å­—æ®µå¯ä»¥è®¾ç½®çš„å€¼å¦‚ä¸‹ã€‚</p> <ul><li>control-groupï¼ˆé»˜è®¤å€¼ï¼‰ï¼šå½“å‰æ§åˆ¶ç»„é‡Œé¢çš„æ‰€æœ‰å­è¿›ç¨‹ï¼Œéƒ½ä¼šè¢«æ€æ‰</li> <li>processï¼šåªæ€ä¸»è¿›ç¨‹</li> <li>mixedï¼šä¸»è¿›ç¨‹å°†æ”¶åˆ° SIGTERM ä¿¡å·ï¼Œå­è¿›ç¨‹æ”¶åˆ° SIGKILL ä¿¡å·</li> <li>noneï¼šæ²¡æœ‰è¿›ç¨‹ä¼šè¢«æ€æ‰ï¼Œåªæ˜¯æ‰§è¡ŒæœåŠ¡çš„ stop å‘½ä»¤ã€‚</li></ul> <p>æ¥ä¸‹æ¥æ˜¯<code>Restart</code>å­—æ®µã€‚</p> <blockquote><p><code>Restart</code>å­—æ®µï¼šå®šä¹‰äº† sshd é€€å‡ºåï¼ŒSystemd çš„é‡å¯æ–¹å¼ã€‚</p></blockquote> <p>ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ<code>Restart</code>è®¾ä¸º<code>on-failure</code>ï¼Œè¡¨ç¤ºä»»ä½•æ„å¤–çš„å¤±è´¥ï¼Œå°±å°†é‡å¯ sshdã€‚å¦‚æœ
sshd æ­£å¸¸åœæ­¢ï¼ˆæ¯”å¦‚æ‰§è¡Œ<code>systemctl stop</code>å‘½ä»¤ï¼‰ï¼Œå®ƒå°±ä¸ä¼šé‡å¯ã€‚</p> <p><code>Restart</code>å­—æ®µå¯ä»¥è®¾ç½®çš„å€¼å¦‚ä¸‹ã€‚</p> <ul><li>noï¼ˆé»˜è®¤å€¼ï¼‰ï¼šé€€å‡ºåä¸ä¼šé‡å¯</li> <li>on-successï¼šåªæœ‰æ­£å¸¸é€€å‡ºæ—¶ï¼ˆé€€å‡ºçŠ¶æ€ç ä¸º 0ï¼‰ï¼Œæ‰ä¼šé‡å¯</li> <li>on-failureï¼šéæ­£å¸¸é€€å‡ºæ—¶ï¼ˆé€€å‡ºçŠ¶æ€ç é 0ï¼‰ï¼ŒåŒ…æ‹¬è¢«ä¿¡å·ç»ˆæ­¢å’Œè¶…æ—¶ï¼Œæ‰ä¼šé‡å¯</li> <li>on-abnormalï¼šåªæœ‰è¢«ä¿¡å·ç»ˆæ­¢å’Œè¶…æ—¶ï¼Œæ‰ä¼šé‡å¯</li> <li>on-abortï¼šåªæœ‰åœ¨æ”¶åˆ°æ²¡æœ‰æ•æ‰åˆ°çš„ä¿¡å·ç»ˆæ­¢æ—¶ï¼Œæ‰ä¼šé‡å¯</li> <li>on-watchdogï¼šè¶…æ—¶é€€å‡ºï¼Œæ‰ä¼šé‡å¯</li> <li>alwaysï¼šä¸ç®¡æ˜¯ä»€ä¹ˆé€€å‡ºåŸå› ï¼Œæ€»æ˜¯é‡å¯</li></ul> <p>å¯¹äºå®ˆæŠ¤è¿›ç¨‹ï¼Œæ¨èè®¾ä¸º<code>on-failure</code>ã€‚å¯¹äºé‚£äº›å…è®¸å‘ç”Ÿé”™è¯¯é€€å‡ºçš„æœåŠ¡ï¼Œå¯ä»¥è®¾
ä¸º<code>on-abnormal</code>ã€‚</p> <p>æœ€åæ˜¯<code>RestartSec</code>å­—æ®µã€‚</p> <blockquote><p><code>RestartSec</code>å­—æ®µï¼šè¡¨ç¤º Systemd é‡å¯æœåŠ¡ä¹‹å‰ï¼Œéœ€è¦ç­‰å¾…çš„ç§’æ•°ã€‚ä¸Šé¢çš„ä¾‹å­è®¾ä¸ºç­‰
å¾… 42 ç§’ã€‚</p></blockquote> <h3 id="_8-7-install-åŒºå—"><a href="#_8-7-install-åŒºå—" class="header-anchor">#</a> 8.7. [Install] åŒºå—</h3> <p><code>Install</code>åŒºå—ï¼Œå®šä¹‰å¦‚ä½•å®‰è£…è¿™ä¸ªé…ç½®æ–‡ä»¶ï¼Œå³æ€æ ·åšåˆ°å¼€æœºå¯åŠ¨ã€‚</p> <p><code>WantedBy</code>å­—æ®µï¼šè¡¨ç¤ºè¯¥æœåŠ¡æ‰€åœ¨çš„ Targetã€‚</p> <p><code>Target</code>çš„å«ä¹‰æ˜¯æœåŠ¡ç»„ï¼Œè¡¨ç¤ºä¸€ç»„æœåŠ¡ã€‚<code>WantedBy=multi-user.target</code>æŒ‡çš„æ˜¯ï¼Œsshd
æ‰€åœ¨çš„ Target æ˜¯<code>multi-user.target</code>ã€‚</p> <p>è¿™ä¸ªè®¾ç½®éå¸¸é‡è¦ï¼Œå› ä¸ºæ‰§è¡Œ<code>systemctl enable sshd.service</code>å‘½ä»¤æ—¶
ï¼Œ<code>sshd.service</code>çš„ä¸€ä¸ªç¬¦å·é“¾æ¥ï¼Œå°±ä¼šæ”¾åœ¨<code>/etc/systemd/system</code>ç›®å½•ä¸‹é¢
çš„<code>multi-user.target.wants</code>å­ç›®å½•ä¹‹ä¸­ã€‚</p> <p>Systemd æœ‰é»˜è®¤çš„å¯åŠ¨ Targetã€‚</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ systemctl get-default
multi-user.target
</code></pre></div><p>ä¸Šé¢çš„ç»“æœè¡¨ç¤ºï¼Œé»˜è®¤çš„å¯åŠ¨ Target æ˜¯<code>multi-user.target</code>ã€‚åœ¨è¿™ä¸ªç»„é‡Œçš„æ‰€æœ‰æœåŠ¡ï¼Œ
éƒ½å°†å¼€æœºå¯åŠ¨ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆ<code>systemctl enable</code>å‘½ä»¤èƒ½è®¾ç½®å¼€æœºå¯åŠ¨çš„åŸå› ã€‚</p> <p>ä½¿ç”¨ Target çš„æ—¶å€™ï¼Œ<code>systemctl list-dependencies</code>å‘½ä»¤å’Œ<code>systemctl isolate</code>å‘½ä»¤ä¹Ÿ
å¾ˆæœ‰ç”¨ã€‚</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># æŸ¥çœ‹ multi-user.target åŒ…å«çš„æ‰€æœ‰æœåŠ¡</span>
$ systemctl list-dependencies multi-user.target

<span class="token comment"># åˆ‡æ¢åˆ°å¦ä¸€ä¸ª target</span>
<span class="token comment"># shutdown.target å°±æ˜¯å…³æœºçŠ¶æ€</span>
$ <span class="token function">sudo</span> systemctl isolate shutdown.target
</code></pre></div><p>ä¸€èˆ¬æ¥è¯´ï¼Œå¸¸ç”¨çš„ Target æœ‰ä¸¤ä¸ªï¼šä¸€ä¸ªæ˜¯<code>multi-user.target</code>ï¼Œè¡¨ç¤ºå¤šç”¨æˆ·å‘½ä»¤è¡ŒçŠ¶æ€
ï¼›å¦ä¸€ä¸ªæ˜¯<code>graphical.target</code>ï¼Œè¡¨ç¤ºå›¾å½¢ç”¨æˆ·çŠ¶æ€ï¼Œå®ƒä¾èµ–äº<code>multi-user.target</code>ã€‚å®˜
æ–¹æ–‡æ¡£æœ‰ä¸€å¼ éå¸¸æ¸…æ™°çš„
<a href="https://www.freedesktop.org/software/systemd/man/bootup.html#System%20Manager%20Bootup" target="_blank" rel="noopener noreferrer">Target ä¾èµ–å…³ç³»å›¾<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã€‚</p> <h3 id="_8-8-target-çš„é…ç½®æ–‡ä»¶"><a href="#_8-8-target-çš„é…ç½®æ–‡ä»¶" class="header-anchor">#</a> 8.8. Target çš„é…ç½®æ–‡ä»¶</h3> <p>Target ä¹Ÿæœ‰è‡ªå·±çš„é…ç½®æ–‡ä»¶ã€‚</p> <div class="language-bash extra-class"><pre class="language-bash"><code>$ systemctl <span class="token function">cat</span> multi-user.target

<span class="token punctuation">[</span>Unit<span class="token punctuation">]</span>
<span class="token assign-left variable">Description</span><span class="token operator">=</span>Multi-User System
<span class="token assign-left variable">Documentation</span><span class="token operator">=</span>man:systemd.special<span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span>
<span class="token assign-left variable">Requires</span><span class="token operator">=</span>basic.target
<span class="token assign-left variable">Conflicts</span><span class="token operator">=</span>rescue.service rescue.target
<span class="token assign-left variable">After</span><span class="token operator">=</span>basic.target rescue.service rescue.target
<span class="token assign-left variable">AllowIsolate</span><span class="token operator">=</span>yes
</code></pre></div><p>æ³¨æ„ï¼ŒTarget é…ç½®æ–‡ä»¶é‡Œé¢æ²¡æœ‰å¯åŠ¨å‘½ä»¤ã€‚</p> <p>ä¸Šé¢è¾“å‡ºç»“æœä¸­ï¼Œä¸»è¦å­—æ®µå«ä¹‰å¦‚ä¸‹ã€‚</p> <ul><li><code>Requires</code>å­—æ®µï¼šè¦æ±‚<code>basic.target</code>ä¸€èµ·è¿è¡Œã€‚</li> <li><code>Conflicts</code>å­—æ®µï¼šå†²çªå­—æ®µã€‚å¦‚æœ<code>rescue.service</code>æˆ–<code>rescue.target</code>æ­£åœ¨è¿è¡Œ
ï¼Œ<code>multi-user.target</code>å°±ä¸èƒ½è¿è¡Œï¼Œåä¹‹äº¦ç„¶ã€‚</li> <li><code>After</code>ï¼šè¡¨ç¤º<code>multi-user.target</code>åœ¨<code>basic.target</code> ã€ <code>rescue.service</code>ã€
<code>rescue.target</code>ä¹‹åå¯åŠ¨ï¼Œå¦‚æœå®ƒä»¬æœ‰å¯åŠ¨çš„è¯ã€‚</li> <li><code>AllowIsolate</code>ï¼šå…è®¸ä½¿ç”¨<code>systemctl isolate</code>å‘½ä»¤åˆ‡æ¢åˆ°<code>multi-user.target</code>ã€‚</li></ul> <h3 id="_8-9-ä¿®æ”¹é…ç½®æ–‡ä»¶åé‡å¯"><a href="#_8-9-ä¿®æ”¹é…ç½®æ–‡ä»¶åé‡å¯" class="header-anchor">#</a> 8.9. ä¿®æ”¹é…ç½®æ–‡ä»¶åé‡å¯</h3> <p>ä¿®æ”¹é…ç½®æ–‡ä»¶ä»¥åï¼Œéœ€è¦é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶ï¼Œç„¶åé‡æ–°å¯åŠ¨ç›¸å…³æœåŠ¡ã€‚</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token comment"># é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶</span>
$ <span class="token function">sudo</span> systemctl daemon-reload

<span class="token comment"># é‡å¯ç›¸å…³æœåŠ¡</span>
$ <span class="token function">sudo</span> systemctl restart foobar
</code></pre></div><h2 id="_9-å‚è€ƒèµ„æ–™"><a href="#_9-å‚è€ƒèµ„æ–™" class="header-anchor">#</a> 9. å‚è€ƒèµ„æ–™</h2> <ul><li><a href="http://www.ruanyifeng.com/blog/2016/03/systemd-tutorial-commands.html" target="_blank" rel="noopener noreferrer">Systemd å…¥é—¨æ•™ç¨‹ï¼šå‘½ä»¤ç¯‡<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="/linux-tutorial/linux/ops/hhttp:/www.ruanyifeng.com/blog/2016/03/systemd-tutorial-part-two.html">Systemd å…¥é—¨æ•™ç¨‹ï¼šå®æˆ˜ç¯‡</a></li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/dunwu/linux-tutorial/edit/master/docs/linux/ops/systemd.md" target="_blank" rel="noopener noreferrer">å¸®åŠ©æˆ‘ä»¬æ”¹å–„æ­¤é¡µé¢ï¼</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">ä¸Šæ¬¡æ›´æ–°:</span> <span class="time">a year ago</span></div></footer> <!----> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/linux-tutorial/assets/js/app.79a38eea.js" defer></script><script src="/linux-tutorial/assets/js/4.fb6e0f89.js" defer></script><script src="/linux-tutorial/assets/js/45.d49955bd.js" defer></script><script src="/linux-tutorial/assets/js/5.cb43ecfb.js" defer></script>
  </body>
</html>
